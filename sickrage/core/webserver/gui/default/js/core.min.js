jQuery(document).ready(function(a){var b={check_notifications:function(){var c="/ui/get_messages";"visible"===document.visibilityState&&a.getJSON(c,function(c){a.each(c,function(a,c){b.notify(c.type,c.title,c.message)})}),setTimeout(function(){"use strict";b.check_notifications()},3e3)},notify:function(a,b,c){var d={desktop:!0,icon:"images/ico/favicon-64.png"},e={dir1:"up",dir2:"left",firstpos1:25,firstpos2:25};PNotify.desktop.permission(),new PNotify({desktop:d,stack:e,addclass:"stack-bottomright",delay:5e3,hide:!0,history:!1,shadow:!1,styling:"jqueryui",width:"340px",type:a,title:b,text:c.replace(/<br[\s\/]*(?:\s[^>]*)?>/gi,"\n").replace(/<[\/]?b(?:\s[^>]*)?>/gi,"*").replace(/<i(?:\s[^>]*)?>/gi,"[").replace(/<[\/]i>/gi,"]").replace(/<(?:[\/]?ul|\/li)(?:\s[^>]*)?>/gi,"").replace(/<li(?:\s[^>]*)?>/gi,"\n* ")})},anon_url:function(a){return null===new URI(a).scheme&&(a="http://"+a),b.anonURL+a},isMeta:function(b,c){var d=new RegExp(c.length>1?c.join("|"):c);return d.test(a('meta[data-var="'+b+'"]').data("content"))},getMeta:function(b){return a('meta[data-var="'+b+'"]').data("content")},metaToBool:function(b){var c=a('meta[data-var="'+b+'"]').data("content");return void 0===c?(console.log(b+" is empty, did you forget to add this to main.mako?"),c):(c=isNaN(c)?c.toLowerCase():c.toString(),!("false"===c||"none"===c||"0"===c))},common:{init:function(){b.srPID=b.getMeta("srPID"),b.srDefaultPage=b.getMeta("srDefaultPage"),b.themeSpinner=b.getMeta("themeSpinner"),b.loading='<img src="/images/loading16'+b.themeSpinner+'.gif" height="16" width="16" />',b.anonURL=b.getMeta("anonURL"),a.scrollUp({animation:"fade",scrollImg:{active:!0,type:"background",src:"images/top.png"}});for(var c=document.getElementsByTagName("img"),d=0;d<c.length;d++)c[d].getAttribute("data-src")&&c[d].setAttribute("src",c[d].getAttribute("data-src"));(navigator.maxTouchPoints||0)<2&&a(".dropdown-toggle").on("click",function(){"true"===a(this).attr("aria-expanded")&&(window.location.href=a(this).attr("href"))}),b.metaToBool("sickrage.FUZZY_DATING")&&(a.timeago.settings.allowFuture=!0,a.timeago.settings.strings={prefixAgo:null,prefixFromNow:"In ",suffixAgo:"ago",suffixFromNow:"",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"an hour",hours:"%d hours",day:"a day",days:"%d days",month:"a month",months:"%d months",year:"a year",years:"%d years",wordSeparator:" ",numbers:[]},a("[datetime]").timeago()),a.tablesorter.addParser({id:"loadingNames",is:function(){return!1},format:function(a){return 0===a.indexOf("Loading...")?a.replace("Loading...","000"):b.metaToBool("sickrage.SORT_ARTICLE")?a||"":(a||"").replace(/^(The|A|An)\s/i,"")},type:"text"}),a.tablesorter.addParser({id:"quality",is:function(){return!1},format:function(a){return a.replace("hd1080p",5).replace("hd720p",4).replace("hd",3).replace("sd",2).replace("any",1).replace("best",0).replace("custom",7)},type:"numeric"}),a.tablesorter.addParser({id:"realISODate",is:function(){return!1},format:function(a){return new Date(a).getTime()},type:"numeric"}),a.tablesorter.addParser({id:"cDate",is:function(){return!1},format:function(a){return a},type:"numeric"}),a.tablesorter.addParser({id:"eps",is:function(){return!1},format:function(a){var c=a.match(/^(.*)/);if(null===c||"?"===c[1])return-10;var d=c[1].split(" / ");if(d[0].indexOf("+")!==-1){var e=d[0].split("+");d[0]=e[0]}if(d[0]=parseInt(d[0]),d[1]=parseInt(d[1]),0===d[0])return d[1];var f=parseInt(b.getMeta("max_download_count")*d[0]/d[1]),g=Math.round(d[0]/d[1]*100)/1e3;return f>0&&(f+=d[0]),f+g},type:"numeric"}),a.confirm.options={confirmButton:"Yes",cancelButton:"Cancel",dialogClass:"modal-dialog",post:!1,confirm:function(a){location.href=a.context.href}},a("a.shutdown").confirm({title:"Shutdown",text:"Are you sure you want to shutdown SiCKRAGE ?"}),a("a.restart").confirm({title:"Restart",text:"Are you sure you want to restart SiCKRAGE ?"}),a("a.clearhistory").confirm({title:"Clear History",text:"Are you sure you want to clear all download history ?"}),a("a.trimhistory").confirm({title:"Trim History",text:"Are you sure you want to trim all download history older than 30 days ?"}),a("a.submiterrors").confirm({title:"Submit Errors",text:'Are you sure you want to submit these errors ?<br><br><span class="red-text">Make sure SiCKRAGE is updated and trigger<br> this error with debug enabled before submitting</span>'}),a("a.removeshow").confirm({title:"Remove Show",text:'Are you sure you want to remove <span class="footerhighlight">'+a("#showtitle").data("showname")+'</span> from the database?<br><br><input type="checkbox" id="deleteFiles"> <span class="red-text">Check to delete files as well. IRREVERSIBLE</span></input>',confirm:function(b){location.href=b.context.href+(a("#deleteFiles")[0].checked?"&full=1":"")}}),a(".plotInfo").qtip({content:{attr:"data-tooltip"},position:{viewport:a(window),my:"left center",adjust:{y:-10,x:2}},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}}),a(".title a").qtip({content:{attr:"data-tooltip"},show:{solo:!0},position:{viewport:a(window),my:"bottom center",at:"top center",adjust:{y:10,x:0}},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}}),a(".imdbstars").qtip({content:{attr:"data-tooltip"},show:{solo:!0},position:{viewport:a(window),my:"right center",at:"center left",adjust:{y:0,x:-6}},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}}),a("#removeW").click(function(){!a("#white option:selected").remove().appendTo("#pool")}),a("#addW").click(function(){!a("#pool option:selected").remove().appendTo("#white")}),a("#addB").click(function(){!a("#pool option:selected").remove().appendTo("#black")}),a("#removeP").click(function(){!a("#pool option:selected").remove()}),a("#removeB").click(function(){!a("#black option:selected").remove().appendTo("#pool")}),a("#addToWhite").click(function(){var b=a("#addToPoolText").val();if(""!==b){var c=a("<option>");c.attr("value",b),c.html(b),c.appendTo("#white"),a("#addToPoolText").val("")}}),a("#addToBlack").click(function(){var b=a("#addToPoolText").val();if(""!==b){var c=a("<option>");c.attr("value",b),c.html(b),c.appendTo("#black"),a("#addToPoolText").val("")}}),a("#ui-components").tabs({activate:function(b,c){var d=a(this).data("lastOpenedPanel");d||(d=a(c.oldPanel)),a(this).data("topPositionTab")||a(this).data("topPositionTab",a(c.newPanel).position().top),a(c.newPanel).hide().fadeIn(0),d&&d.toggleClass("ui-tabs-hide").css("position","absolute").css("top",a(this).data("topPositionTab")+"px").fadeOut(0,function(){a(this).css("position","")}),a(this).data("lastOpenedPanel",a(c.newPanel))}}),b.browser.init(),b.root_dirs.init(),b.quality_chooser.init(),b.check_notifications()}},ajax_search:{searchStatusUrl:"/home/getManualSearchStatus",failedDownload:!1,qualityDownload:!1,selectedEpisode:"",manualSearches:[],init:function(){PNotify.prototype.options.maxonscreen=5,b.ajax_search.ajaxEpSearch({colorRow:!0}),b.ajax_search.checkManualSearches(),b.ajax_search.ajaxEpSubtitlesSearch()},enableLink:function(a){a.on("click.disabled",!1),a.prop("enableClick","1"),a.fadeTo("fast",1)},disableLink:function(a){a.off("click.disabled"),a.prop("enableClick","0"),a.fadeTo("fast",.5)},updateImages:function(c){a.each(c.episodes,function(c,d){var e="loading16.gif",f="queued.png",g="search16.png",h="",i=a("a[id="+d.show+"x"+d.season+"x"+d.episode+"]"),j=i.children("img"),k=i.parent();if(i){var l="";"searching"===d.searchstatus.toLowerCase()?(j.prop("title","Searching"),j.prop("alt","Searching"),j.prop("src","/images/"+e),b.ajax_search.disableLink(i),h=d.searchstatus):"queued"===d.searchstatus.toLowerCase()?(j.prop("title","Queued"),j.prop("alt","queued"),j.prop("src","/images/"+f),b.ajax_search.disableLink(i),h=d.searchstatus):"finished"===d.searchstatus.toLowerCase()&&(j.prop("title","Searching"),j.prop("alt","searching"),j.parent().prop("class","epRetry"),j.prop("src","/images/"+g),b.ajax_search.enableLink(i),l=/(\w+)\s\((.+?)\)/,h=d.status.replace(l,'$1 <span class="quality '+d.quality+'">$2</span>'),k.closest("tr").prop("class",d.overview+" season-"+d.season+" seasonstyle")),k.siblings(".col-status").html(h)}var m=a("a[id=forceUpdate-"+d.show+"x"+d.season+"x"+d.episode+"]"),n=m.children("img");m&&("searching"===d.searchstatus.toLowerCase()?(n.prop("title","Searching"),n.prop("alt","Searching"),n.prop("src","/images/"+e),b.ajax_search.disableLink(m)):"queued"===d.searchstatus.toLowerCase()?(n.prop("title","Queued"),n.prop("alt","queued"),n.prop("src","/images/"+f)):"finished"===d.searchstatus.toLowerCase()&&(n.prop("title","Manual Search"),n.prop("alt","[search]"),n.prop("src","/images/"+g),"snatched"===d.overview.toLowerCase()?m.closest("tr").remove():b.ajax_search.enableLink(m)))})},manualSearch:function(c){var d,e,f,g=b.ajax_search.selectedEpisode.parent(),h=b.ajax_search.selectedEpisode,i=b.ajax_search.selectedEpisode.children("img");i.prop("title","loading"),i.prop("alt",""),i.prop("src","/images/"+c.loadingImage);var j=b.ajax_search.selectedEpisode.prop("href");return b.ajax_search.failedDownload===!1&&(j=j.replace("retryEpisode","searchEpisode")),j=j+"&downCurQuality="+(b.ajax_search.qualityDownload?"1":"0"),a.getJSON(j,function(a){if("failure"===a.result.toLowerCase())d=c.noImage,e="failed";else{d=c.loadingImage,e="success",c.colorRow&&g.parent().removeClass("skipped wanted qual good unaired").addClass("snatched");var j=/(\w+)\s\((.+?)\)/;f=a.result.replace(j,'$1 <span class="quality '+a.quality+'">$2</span>'),g.siblings(".col-status").html(f),b.ajax_search.disableLink(h)}i.prop("title",e),i.prop("alt",e),i.prop("height",c.size),i.prop("src","/images/"+d)}),!1},checkManualSearches:function(){var c=5e3,d=a("#showID").val(),e=void 0!==d?b.ajax_search.searchStatusUrl+"?show="+d:b.ajax_search.searchStatusUrl;a.ajax({url:e,success:function(a){c=a.episodes?5e3:15e3,b.ajax_search.updateImages(a)},error:function(){c=3e4},type:"GET",dataType:"json",complete:function(){setTimeout(b.ajax_search.checkManualSearches,c)},timeout:15e3})},ajaxEpSearch:function(c){var d={size:16,colorRow:!1,loadingImage:"loading16.gif",queuedImage:"queued.png",noImage:"no16.png",yesImage:"yes16.png"};c=a.extend({},d,c),a(".epRetry").click(function(c){return c.preventDefault(),"0"!==a(this).prop("enableClick")&&(b.ajax_search.selectedEpisode=a(this),void a("#manualSearchModalFailed").modal("show"))}),a(".epSearch").click(function(d){return d.preventDefault(),"0"!==a(this).prop("enableClick")&&(b.ajax_search.selectedEpisode=a(this),void(a(this).parent().parent().children(".col-status").children(".quality").length?a("#manualSearchModalQuality").modal("show"):b.ajax_search.manualSearch(c)))}),a("#manualSearchModalFailed .btn").click(function(){b.ajax_search.failedDownload="yes"===a(this).text().toLowerCase(),a("#manualSearchModalQuality").modal("show")}),a("#manualSearchModalQuality .btn").click(function(){b.ajax_search.qualityDownload="yes"===a(this).text().toLowerCase(),b.ajax_search.manualSearch(c)})},ajaxEpSubtitlesSearch:function(){a(".epSubtitlesSearch").click(function(){var b=a(this).parent().siblings(".col-subtitles"),c=a(this);return c.empty(),c.append(a("<img/>").attr({src:"/images/loading16.gif",alt:"",title:"loading"})),a.getJSON(a(this).attr("href"),function(d){if("failure"!==d.result.toLowerCase()&&"no subtitles downloaded"!==d.result.toLowerCase()){var e=d.subtitles.split(",");b.empty(),a.each(e,function(c,d){""!==d&&"und"!==d&&(c!==e.length-1?b.append(a("<img/>").attr({src:"/images/subtitles/flags/"+d+".png",alt:d,width:16,height:11})):b.append(a("<img/>").attr({src:"/images/subtitles/flags/"+d+".png",alt:d,width:16,height:11})))}),c.remove()}else c.remove()}),!1})},ajaxEpMergeSubtitles:function(){a(".epMergeSubtitles").click(function(){var b=a(this);return b.empty(),b.append(a("<img/>").attr({src:"/images/loading16.gif",alt:"",title:"loading"})),a.getJSON(a(this).attr("href"),function(){b.remove()}),!1})}},browser:{defaults:{title:"Choose Directory",url:"/browser/",autocompleteURL:"/browser/complete",includeFiles:0,showBrowseButton:!0},fileBrowserDialog:null,currentBrowserPath:null,currentRequest:null,init:function(){a.fn.nFileBrowser=b.browser.nFileBrowser,a.fn.fileBrowser=b.browser.fileBrowser},browse:function(c,d,e){b.browser.currentBrowserPath!==c&&(b.browser.currentBrowserPath=c,b.browser.currentRequest&&b.browser.currentRequest.abort(),b.browser.fileBrowserDialog.dialog("option","dialogClass","browserDialog busy"),b.browser.currentRequest=a.getJSON(d,{path:c,includeFiles:e},function(c){b.browser.fileBrowserDialog.empty();var f,g=c[0],h=0,i=null;c=a.grep(c,function(){return 0!==h++}),a('<input type="text" class="form-control input-sm">').val(g.currentPath).on("keypress",function(a){13===a.which&&b.browser.browse(a.target.value,d,e)}).appendTo(b.browser.fileBrowserDialog).fileBrowser({showBrowseButton:!1}).on("autocompleteselect",function(a,c){b.browser.browse(c.item.value,d,e)}),f=a("<ul>").appendTo(b.browser.fileBrowserDialog),a.each(c,function(c,g){i=a('<a href="javascript:void(0)">').on("click",function(){g.isFile?(b.browser.currentBrowserPath=g.path,a('.browserDialog .ui-button:contains("Ok")').click()):b.browser.browse(g.path,d,e)}).text(g.name),g.isFile?i.prepend('<span class="ui-icon ui-icon-blank"></span>'):i.prepend('<span class="ui-icon ui-icon-folder-collapsed"></span>').on("mouseenter",function(){a("span",this).addClass("ui-icon-folder-open")}).on("mouseleave",function(){a("span",this).removeClass("ui-icon-folder-open")}),i.appendTo(f)}),a("a",f).wrap('<li class="ui-state-default ui-corner-all">'),b.browser.fileBrowserDialog.dialog("option","dialogClass","browserDialog")}))},nFileBrowser:function(c,d){d=a.extend({},b.browser.defaults,d),b.browser.fileBrowserDialog||(b.browser.fileBrowserDialog=a('<div id="fileBrowserDialog" style="display:hidden"></div>').appendTo("body").dialog({dialogClass:"browserDialog",title:d.title,position:["center",40],minWidth:Math.min(a(document).width()-80,650),height:Math.min(a(document).height()-80,a(window).height()-80),maxHeight:Math.min(a(document).height()-80,a(window).height()-80),maxWidth:a(document).width()-80,modal:!0,autoOpen:!1})),b.browser.fileBrowserDialog.dialog("option","buttons",[{text:"Ok",class:"btn",click:function(){c(b.browser.currentBrowserPath,d),a(this).dialog("close")}},{text:"Cancel",class:"btn",click:function(){a(this).dialog("close")}}]);var e="";return d.initialDir&&(e=d.initialDir),b.browser.browse(e,d.url,d.includeFiles),b.browser.fileBrowserDialog.dialog("open"),!1},fileBrowser:function(c){if(c=a.extend({},b.browser.defaults,c),c.field=a(this),c.field.autocomplete&&c.autocompleteURL){var d="";c.field.autocomplete({position:{my:"top",at:"bottom",collision:"flipfit"},source:function(b,e){d=a.ui.autocomplete.escapeRegex(b.term,c.includeFiles),a.ajax({url:c.autocompleteURL,data:b,dataType:"json",success:function(b){var c=new RegExp("^"+d,"i"),f=a.grep(b,function(a){return c.test(a)});e(f)}})},open:function(){a(".ui-autocomplete li.ui-menu-item a").removeClass("ui-corner-all"),a(".ui-autocomplete li.ui-menu-item:odd a").addClass("ui-menu-item-alternate")}}).data("ui-autocomplete")._renderItem=function(b,c){var e=c.label,f=new RegExp("(?![^&;]+;)(?!<[^<>]*)("+d+")(?![^<>]*>)(?![^&;]+;)","gi");return e=e.replace(f,function(a){return"<b>"+a+"</b>"}),a("<li></li>").data("ui-autocomplete-item",c).append("<a class='nowrap'>"+e+"</a>").appendTo(b)}}var e,f,g=!1;try{g=!!localStorage.getItem}catch(a){}return g&&c.key&&(e=localStorage["fileBrowser-"+c.key]),c.key&&0===c.field.val().length&&e&&c.field.val(e),f=function(a,b){b.field.val(a),g&&b.key&&(localStorage["fileBrowser-"+b.key]=a)},c.field.addClass("fileBrowserField"),c.showBrowseButton&&c.field.after(a('<input type="button" value="Browse&hellip;" class="btn btn-inline fileBrowser">').on("click",function(){var b=c.field.val()||c.key&&e||"",d=a.extend({},c,{initialDir:b});return a(this).nFileBrowser(f,d),!1})),c.field}},root_dirs:{init:function(){for(var c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;){var f=c[d];e[f]||(e[f]=function(){})}a("#addRootDir").click(function(){a(this).nFileBrowser(b.root_dirs.addRootDir)}),a("#editRootDir").click(function(){a(this).nFileBrowser(b.root_dirs.editRootDir,{initialDir:a("#rootDirs option:selected").val()})}),a("#deleteRootDir").click(function(){if(a("#rootDirs option:selected").length){var c=a("#rootDirs option:selected"),d=c.attr("id")===a("#whichDefaultRootDir").val(),f=a("#rootDirs option:selected").attr("id").substr(3);if(c.remove(),b.root_dirs.syncOptionIDs(),d)e.log("new default when deleting"),a("#whichDefaultRootDir").val(""),a("#rootDirs option").length&&b.root_dirs.setDefault(a("#rootDirs option").attr("id"));else if(a("#whichDefaultRootDir").val().length){var g=a("#whichDefaultRootDir").val().substr(3);g>f&&a("#whichDefaultRootDir").val("rd-"+(g-1))}}b.root_dirs.refreshRootDirs(),a.get("/config/general/saveRootDirs",{rootDirString:a("#rootDirText").val()})}),a("#defaultRootDir").click(function(){a("#rootDirs option:selected").length&&b.root_dirs.setDefault(a("#rootDirs option:selected").attr("id")),b.root_dirs.refreshRootDirs(),a.get("/config/general/saveRootDirs",{rootDirString:a("#rootDirText").val()})}),a("#rootDirs").click(b.root_dirs.refreshRootDirs),b.root_dirs.syncOptionIDs(),b.root_dirs.setDefault(a("#whichDefaultRootDir").val(),!0),b.root_dirs.refreshRootDirs()},addRootDir:function(c){if(c.length){var d=!1;a("#whichDefaultRootDir").val().length||(d=!0),a("#rootDirs").append('<option value="'+c+'">'+c+"</option>"),b.root_dirs.syncOptionIDs(),d&&b.root_dirs.setDefault(a("#rootDirs option").attr("id")),b.root_dirs.refreshRootDirs(),a.get("/config/general/saveRootDirs",{rootDirString:a("#rootDirText").val()})}},editRootDir:function(c){c.length&&(a("#rootDirs option:selected").length&&(a("#rootDirs option:selected").attr("id")===a("#whichDefaultRootDir").val()?a("#rootDirs option:selected").text("*"+c):a("#rootDirs option:selected").text(c),a("#rootDirs option:selected").val(c)),b.root_dirs.refreshRootDirs(),a.get("/config/general/saveRootDirs",{rootDirString:a("#rootDirText").val()}))},setDefault:function(b,c){if(console.log("setting default to "+b),(void 0===b||b.length)&&(a("#whichDefaultRootDir").val()!==b||c===!0)){if("*"!==a("#"+b).text().charAt(0)&&a("#"+b).text("*"+a("#"+b).text()),a("#whichDefaultRootDir").val()&&c!==!0){var d=a("#"+a("#whichDefaultRootDir").val());d.text(d.text().substring(1))}a("#whichDefaultRootDir").val(b)}},syncOptionIDs:function(){var b=0;a("#rootDirs option").each(function(){a(this).attr("id","rd-"+b++)})},refreshRootDirs:function(){if(a("#rootDirs").length){var c="true";b.root_dirs.syncOptionIDs(),!a("#rootDirs option:selected").length&&a("#whichDefaultRootDir").val().length&&a("#"+a("#whichDefaultRootDir").val()).prop("selected",!0),a("#rootDirs option:selected").length&&(c=""),a("#deleteRootDir").prop("disabled",c),a("#defaultRootDir").prop("disabled",c),a("#editRootDir").prop("disabled",c);var d="",e="";a("#whichDefaultRootDir").val().length>=4&&(e=a("#whichDefaultRootDir").val().substr(3)),a("#rootDirs option").each(function(){d+=a(this).val()+"="+a(this).text()+"->"+a(this).attr("id")+"\n",e.length&&(e+="|"+a(this).val())}),d+="def: "+a("#whichDefaultRootDir").val(),console.log(d),a("#rootDirText").val(e),a("#rootDirText").change(),console.log("rootDirText: "+a("#rootDirText").val())}}},quality_chooser:{init:function(){a("#qualityPreset").change(function(){b.quality_chooser.setFromPresets(a("#qualityPreset :selected").val())}),b.quality_chooser.setFromPresets(a("#qualityPreset :selected").val())},setFromPresets:function(b){return 0===parseInt(b)?void a("#customQuality").show():(a("#customQuality").hide(),a("#anyQualities option").each(function(){var c=b&a(this).val();c>0?a(this).attr("selected","selected"):a(this).attr("selected",!1)}),void a("#bestQualities option").each(function(){var c=b&a(this).val()<<16;c>0?a(this).attr("selected","selected"):a(this).attr("selected",!1)}))}},root:{init:function(){},schedule:function(){if(b.isMeta("sickrage.COMING_EPS_LAYOUT",["list"])){var c={date:0,show:2,network:5},d=b.getMeta("sickrage.COMING_EPS_SORT"),e=d in c?[[c[d],0]]:[[0,0]];a("#showListTable:has(tbody tr)").tablesorter({widgets:["stickyHeaders","filter","columnSelector","saveSort"],sortList:e,textExtraction:{0:function(b){return a(b).find("time").attr("datetime")},1:function(b){return a(b).find("time").attr("datetime")},7:function(b){return a(b).find("span").text().toLowerCase()}},headers:{0:{sorter:"realISODate"},1:{sorter:"realISODate"},2:{sorter:"loadingNames"},4:{sorter:"loadingNames"},7:{sorter:"quality"},8:{sorter:!1},9:{sorter:!1}},widgetOptions:function(){return b.metaToBool("sickrage.FILTER_ROW")?{filter_columnFilters:!0,filter_hideFilters:!0,filter_saveFilters:!0,columnSelector_mediaquery:!1}:{filter_columnFilters:!1,columnSelector_mediaquery:!1}}()}),b.ajax_search.ajaxEpSearch()}b.isMeta("sickrage.COMING_EPS_LAYOUT",["banner","poster"])&&(b.ajax_search.ajaxEpSearch({size:16,loadingImage:"loading16"+b.themeSpinner+".gif"}),a(".ep_summary").hide(),a(".ep_summaryTrigger").click(function(){a.next(".ep_summary").slideToggle("normal",function(){a.prev(".ep_summaryTrigger").attr("src",function(b,c){return a.next(".ep_summary").is(":visible")?c.replace("plus","minus"):c.replace("minus","plus")})})})),a("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",function(){a.tablesorter.columnSelector.attachTo(a("#showListTable"),"#popover-target")})},history:function(){a("#historyTable:has(tbody tr)").tablesorter({widgets:["zebra","filter"],sortList:[[0,1]],textExtraction:function(){return b.isMeta("sickrage.HISTORY_LAYOUT",["detailed"])?{0:function(b){return a(b).find("time").attr("datetime")},4:function(b){return a(b).find("span").text().toLowerCase()}}:{0:function(b){return a(b).find("time").attr("datetime")},1:function(b){return a(b).find("span").text().toLowerCase()},2:function(b){return a(b).attr("data-provider").toLowerCase()},5:function(b){return a(b).attr("data-quality").toLowerCase()}}}(),headers:function(){return b.isMeta("sickrage.HISTORY_LAYOUT",["detailed"])?{0:{sorter:"realISODate"},4:{sorter:"data-quality"}}:{0:{sorter:"realISODate"},4:{sorter:!1},5:{sorter:"data-quality"}}}()}),a("#history_limit").on("change",function(){window.location.href="/history/?limit="+a(this).val()})},api_builder:function(){a("[data-action=api-call]").on("click",function(){var b=a("[data-command="+a(this).data("command-name")+"]"),c=a("#option-profile").is(":checked"),d=a(this).data("target"),e=a(this).data("time"),f=a("#"+a(this).data("base-url")).text(),g=a(this).data("url");a.each(b,function(b,c){var d=a(c).attr("name"),e=a(c).val();void 0!==d&&void 0!==e&&d!==e&&e&&(a.isArray(e)&&(e=e.join("|")),f+="&"+d+"="+e)}),c&&(f+="&profile=1");var h=(new Date).getTime();a.get(f,function(b,c,i){var j=(new Date).getTime()-h,k=a("#option-jsonp").is(":checked"),l=i.getResponseHeader("content-type")||"",m=a(d);if(a(e).text(j+"ms"),a(g).text(f+(k?"&jsonp=foo":"")),"image/"===l.slice(0,6))m.html(a("<img/>").attr("src",f));else{var n=JSON.stringify(b,null,4);k?m.text("foo("+n+");"):m.text(n)}m.parents(".result-wrapper").removeClass("hidden")})}),a("[data-action=clear-result]").on("click",function(){a(a(this).data("target")).html("").parents(".result-wrapper").addClass("hidden")}),a("[data-action=update-episodes]").on("change",function(){var b=a(this).data("command"),c=a("[data-command="+b+"][name=episode]"),d=a(this).val(),e=a("[data-command="+b+"][name=indexerid]").val(),f=c.val();if(void 0!==c){c.removeClass("hidden"),c.find("option:gt(0)").remove();for(var g in f[e][d])f[e][d].hasOwnProperty(g)&&c.append(a("<option>",{value:g,label:"Episode "+g}))}}),a("[data-action=update-seasons]").on("change",function(){var b=a(this).data("command"),c=a("[data-command="+b+"][name=season]"),d=a(this).val(),e=c.val();if(void 0!==c){c.removeClass("hidden"),c.find("option:gt(0)").remove();for(var f in e[d])e[d].hasOwnProperty(f)&&c.append(a("<option>",{value:f,label:0===f?"Specials":"Season "+f}))}}),a("#command-search").typeahead({source:b.getMeta("commands")}),a("#command-search").on("change",function(){var b=a(this).typeahead("getActive");if(b){var c=b.replace(".","-");a("[href=#command-"+c+"]").click()}})},status:function(){a("#schedulerStatusTable").tablesorter({widgets:["saveSort","zebra"]}),a("#queueStatusTable").tablesorter({widgets:["saveSort","zebra"],sortList:[[3,0],[4,0],[2,1]]})}},google:{init:function(){},login:function(){a.ajax({dataType:"json",url:"/google/get_user_code",type:"POST",success:function(c){var d="<center><h1>"+c.user_code+'</h1><br/>From any computer, please visit <a href="'+c.verification_url+'" target="_blank">'+c.verification_url+"</a> and enter the code</center>";a("#login-dialog").dialog({modal:!0,draggable:!1,width:"25%",title:"Link SiCKRAGE"}).html(d),b.google.poll_auth(c,(new Date).getTime()+1e3*new Date(c.user_code_expiry).getTime(),c.interval)}})},logout:function(){a.ajax({url:"/google/logout",success:function(){localStorage.clear(),location.reload()}})},poll_auth:function(c,d,e){(new Date).getTime()<d&&a.ajax({dataType:"json",url:"/google/get_credentials",data:{flow_info:JSON.stringify(c)},type:"POST",success:function(f){f.error?("slow_down"===f.error&&(e+=5),setTimeout(function(){b.google.poll_auth(c,d,e)},1e3*e)):(a("#login-dialog").dialog("close"),localStorage.setItem("google_refresh_token",f.refresh_token),localStorage.setItem("google_access_token",f.access_token),localStorage.setItem("google_token_type",f.token_type),location.reload())}})},refresh_auth:function(){a.ajax({dataType:"json",url:"/google/refresh_credentials",data:{token:localStorage.getItem("google_refresh_token")},type:"POST",success:function(a){localStorage.setItem("google_access_token",a.access_token),localStorage.setItem("google_token_type",a.token_type)},error:function(){b.google.logout()}})}},home:{init:function(){b.home.add_show_options(),b.root_dirs.init()},index:function(){a(".resetsorting").on("click",function(){a("table").trigger("filterReset")}),a(".progressbar").each(function(){var b=a(this).data("progress-percentage"),c=100===b?100:b>80?80:b>60?60:b>40?40:20;a(this).progressbar({value:b}),a(this).data("progress-text")&&a(this).append('<div class="progressbarText" title="'+a(this).data("progress-tip")+'">'+a(this).data("progress-text")+"</div>"),a(this).find(".ui-progressbar-value").addClass("progress-"+c)}),a("img#network").on("error",function(){a(this).parent().text(a(this).attr("alt")),a(this).remove()}),a("#showListTableShows:has(tbody tr), #showListTableAnime:has(tbody tr)").tablesorter({sortList:[[6,1],[2,0]],textExtraction:{0:function(b){return a(b).find("time").attr("datetime")},1:function(b){return a(b).find("time").attr("datetime")},3:function(b){return a(b).find("span").prop("title").toLowerCase()},4:function(b){return a(b).find("span").text().toLowerCase()},5:function(b){return a(b).find("span:first").text()},6:function(b){return a(b).find("img").attr("alt")}},widgets:["saveSort","zebra","stickyHeaders","filter","columnSelector"],headers:function(){return b.metaToBool("sickrage.FILTER_ROW")?{0:{sorter:"realISODate"},1:{sorter:"realISODate"},2:{sorter:"loadingNames"},4:{sorter:"quality"},5:{sorter:"eps"},6:{filter:"parsed"}}:{0:{sorter:"realISODate"},1:{sorter:"realISODate"},2:{sorter:"loadingNames"},4:{sorter:"quality"},5:{sorter:"eps"}}}(),widgetOptions:function(){return b.metaToBool("sickrage.FILTER_ROW")?{filter_columnFilters:!0,filter_hideFilters:!0,filter_functions:{5:function(a,b,c){var d=!1,e=Math.floor(b%1*1e3);if(""===c)d=!0;else{var f=c.match(/(<|<=|>=|>)\s(\d+)/i);f&&("<"===f[1]?e<parseInt(f[2])&&(d=!0):"<="===f[1]?e<=parseInt(f[2])&&(d=!0):">="===f[1]?e>=parseInt(f[2])&&(d=!0):">"===f[1]&&e>parseInt(f[2])&&(d=!0)),f=c.match(/(\d+)\s(-|to)\s(\d+)/i),f&&("-"!==f[2]&&"to"!==f[2]||e>=parseInt(f[1])&&e<=parseInt(f[3])&&(d=!0)),f=c.match(/(=)?\s?(\d+)\s?(=)?/i),f&&("="!==f[1]&&"="!==f[3]||parseInt(f[2])===e&&(d=!0)),!isNaN(parseFloat(c))&&isFinite(c)&&parseInt(c)===e&&(d=!0)}return d}},columnSelector_mediaquery:!1}:{filter_columnFilters:!1}}(),sortStable:!0,sortAppend:[[2,0]]}),a("#showListTableShows").find("tbody").find("tr").size()>0&&a.tablesorter.filter.bindSearch("#showListTableShows",a(".search")),b.metaToBool("sickrage.ANIME_SPLIT_HOME")&&a("#showListTableAnime").find("tbody").find("tr").size()>0&&a.tablesorter.filter.bindSearch("#showListTableAnime",a(".search"));var c=[a("#container"),a("#container-anime")];a.each(c,function(){a(this).isotope({itemSelector:".show",sortBy:b.getMeta("sickrage.POSTER_SORTBY"),sortAscending:b.getMeta("sickrage.POSTER_SORTDIR"),layoutMode:"masonry",masonry:{columnWidth:13,isFitWidth:!0},getSortData:{name:function(c){var d=a(c).attr("data-name");return b.metaToBool("sickrage.SORT_ARTICLE")?d||"":(d||"").replace(/^(The|A|An)\s/i,"")},network:"[data-network]",date:function(b){var c=a(b).attr("data-date");return c.length&&parseInt(c,10)||Number.POSITIVE_INFINITY},progress:function(b){var c=a(b).attr("data-progress");return c.length&&parseInt(c,10)||Number.NEGATIVE_INFINITY}}})}),a("#postersort").on("change",function(){var b=a(this).value;a("#container").isotope({sortBy:b}),a("#container-anime").isotope({sortBy:b}),a.get(a(this).options[a(this).selectedIndex].getAttribute("data-sort"))}),a("#postersortdirection").on("change",function(){var b=a(this).value;b="true"===b,a("#container").isotope({sortAscending:b}),a("#container-anime").isotope({sortAscending:b}),a.get(a(this).options[a(this).selectedIndex].getAttribute("data-sort"))}),a("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",function(){a.tablesorter.columnSelector.attachTo(a("#showListTableShows"),"#popover-target"),b.metaToBool("sickrage.ANIME_SPLIT_HOME")&&a.tablesorter.columnSelector.attachTo(a("#showListTableAnime"),"#popover-target")})},display_show:{init:function(){b.home.display_show.imdb_stars(),b.ajax_search.init(),a("#seasonJump").on("change",function(){var b=a("#seasonJump option:selected").val();if(b&&"jump"!==b){var c=a("#seasonJump option:selected").data("season");a("html,body").animate({scrollTop:a('[name ="'+b.substring(1)+'"]').offset().top-50},"slow"),a("#collapseSeason-"+c).collapse("show"),location.hash=b}a(this).val("jump")}),a("#prevShow").on("click",function(){a("#pickShow option:selected").prev("option").prop("selected","selected"),a("#pickShow").change()}),a("#nextShow").on("click",function(){a("#pickShow option:selected").next("option").prop("selected","selected"),a("#pickShow").change()}),a("#changeStatus").on("click",function(){var b=[];return a(".epCheck").each(function(){a(this).prop("checked")&&b.push(a(this).attr("id"))}),0!==b.length&&void(window.location.href="/home/setStatus?show="+a("#showID").attr("value")+"&eps="+b.join("|")+"&status="+a("#statusSelect").val())}),a("#deleteEpisode").on("click",function(){var b=[];return a(".epCheck").each(function(){a(this).prop("checked")&&b.push(a(this).attr("id"))}),0!==b.length&&void(window.location.href="/home/deleteEpisode?show="+a("#showID").attr("value")+"&eps="+b.join("|"))}),a(".seasonCheck").on("click",function(){var b=this,c=a(b).attr("id");a("#collapseSeason-"+c).collapse("show"),a(".epCheck:visible").each(function(){var d=a(this).attr("id").split("x");d[0]===c&&a(this).prop("checked",b.checked)})});var c=null;a(".epCheck").on("click",function(b){if(!c||!b.shiftKey)return void(c=this);var d=this,e=0;a(".epCheck").each(function(){switch(e){case 2:return!1;case 1:a(this).prop("checked",c.checked)}a(this)!==d&&a(this)!==c||e++})}),a(".seriesCheck").on("click",function(){a(".epCheck:visible").each(function(){a(this).prop("checked",!0);
}),a(".seasonCheck:visible").each(function(){a(this).prop("checked",!0)})}),a(".clearAll").on("click",function(){a(".epCheck:visible").each(function(){a(this).prop("checked",!1)}),a(".seasonCheck:visible").each(function(){a(this).prop("checked",!1)})}),a("#pickShow").on("change",function(){var b=a(this).val();0!==b&&(window.location.href="/home/displayShow?show="+b)}),a("#checkboxControls input").change(function(){var c=a(this).attr("id");b.home.display_show.showHideRows(c)}),a("#checkboxControls input").each(function(){var b=a(this).prop("checked");a("tr."+a(this).attr("id")).each(function(){b?a(this).show():a(this).hide()})}),a(".sceneSeasonXEpisode").on("change",function(){a(this).val(a(this).val().replace(/[^0-9xX]*/g,""));var c=a(this).attr("data-for-season"),d=a(this).attr("data-for-episode"),e=a(this).val().match(/^(\d+)x(\d+)$/i),f=null,g=null;e&&(f=e[1],g=e[2]),b.home.display_show.setEpisodeSceneNumbering(c,d,f,g)}),a(".sceneAbsolute").on("change",function(){a(this).val(a(this).val().replace(/[^0-9xX]*/g,""));var c=a(this).attr("data-for-absolute"),d=a(this).val().match(/^(\d{1,3})$/i),e=null;d&&(e=d[1]),b.home.display_show.setAbsoluteSceneNumbering(c,e)}),a(".addQTip").each(function(){a(this).css({cursor:"help","text-shadow":"0px 0px 0.5px #666"}),a(this).qtip({show:{solo:!0},position:{viewport:a(window),my:"left center",adjust:{y:-10,x:2}},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}})}),a("#showTable, #animeTable").tablesorter({widgets:["saveSort","stickyHeaders","columnSelector"],widgetOptions:{columnSelector_saveColumns:!0,columnSelector_layout:'<br><label><input type="checkbox">{name}</label>',columnSelector_mediaquery:!1,columnSelector_cssChecked:"checked"}}),a("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",function(){a.tablesorter.columnSelector.attachTo(a("#showTable, #animeTable"),"#popover-target")})},showHideRows:function(b){var c=a("#checkboxControls > input, #"+b).prop("checked");a("tr."+b).each(function(){c?a(this).show():a(this).hide()}),a("tr.seasonheader").each(function(){var b=0,c=a(this).attr("id");a("tr."+c+" :visible").each(function(){b++}),0===b?(a(this).hide(),a("#"+c+"-cols").hide()):(a(this).show(),a("#"+c+"-cols").show())})},setEpisodeSceneNumbering:function(b,c,d,e){var f=a("#showID").val(),g=a("#indexer").val();""===d&&(d=null),""===e&&(e=null),a.getJSON("/home/setSceneNumbering",{show:f,indexer:g,forSeason:b,forEpisode:c,sceneSeason:d,sceneEpisode:e},function(d){null===d.sceneSeason||null===d.sceneEpisode?a("#sceneSeasonXEpisode_"+f+"_"+b+"_"+c).val(""):a("#sceneSeasonXEpisode_"+f+"_"+b+"_"+c).val(d.sceneSeason+"x"+d.sceneEpisode),d.success||(d.errorMessage?alert(d.errorMessage):alert("Update failed."))})},setAbsoluteSceneNumbering:function(b,c){var d=a("#showID").val(),e=a("#indexer").val();""===c&&(c=null),a.getJSON("/home/setSceneNumbering",{show:d,indexer:e,forAbsolute:b,sceneAbsolute:c},function(c){null===c.sceneAbsolute?a("#sceneAbsolute_"+d+"_"+b).val(""):a("#sceneAbsolute_"+d+"_"+b).val(c.sceneAbsolute),c.success||(c.errorMessage?alert(c.errorMessage):alert("Update failed."))})},imdb_stars:function(){return a(".imdbstars").each(function(b,c){a(c).html(a("<span/>").width(12*a(c).text()))})}},edit_show:{init:function(){var c=[];a("#location").fileBrowser({title:"Select Show Location"}),a("#submit").click(function(){var c=[];a("#exceptions_list option").each(function(){c.push(a(this).val())}),a("#exceptions_list").val(c),b.metaToBool("show.is_anime")&&b.generate_bwlist()}),a("#addSceneName").click(function(){var b=a("#SceneName").val(),d=a("<option>");if(c=[],a("#exceptions_list option").each(function(){c.push(a(this).val())}),a("#SceneName").val(""),!(a.inArray(b,c)>-1||""===b))return a("#SceneException").show(),d.attr("value",b),d.html(b),d.appendTo("#exceptions_list")}),a("#removeSceneName").click(function(){a("#exceptions_list option:selected").remove(),b.home.edit_show.toggleSceneException()}),b.home.edit_show.toggleSceneException()},toggleSceneException:function(){var b=[];a("#exceptions_list option").each(function(){b.push(a(this).val())}),""===b?a("#SceneException").hide():a("#SceneException").show()}},add_existing_shows:{init:function(){a("#tabs").tabs({collapsible:!0,selected:b.metaToBool("sickrage.SORT_ARTICLE")?-1:0}),a("#tableDiv").on("click","#checkAll",function(){a(".dirCheck").not(this).prop("checked",this.checked)}),a("#submitShowDirs").on("click",function(){var b=[];if(a(".dirCheck").each(function(){if(a(this).prop("checked")){var c=a(this).attr("id"),d=a(this).closest("tr").find("select").val();b.push(encodeURIComponent(d+"|"+c))}}),0===b.length)return!1;var c="/home/addShows/addExistingShows?promptForSettings="+(a("#promptForSettings").prop("checked")?"on":"off")+"&shows_to_add="+b.join("&shows_to_add=");c.length<2083?window.location.href=c:alert("You've selected too many shows, please uncheck some and try again. ["+c.length+"/2083 characters]")});var c="";a("#rootDirText").on("change",function(){return c!==a("#rootDirText").val()&&(c=a("#rootDirText").val(),a("#rootDirStaticList").html(""),a("#rootDirs option").each(function(b,c){a("#rootDirStaticList").append('<li class="ui-state-default ui-corner-all"><input type="checkbox" class="cb dir_check" id="'+a(c).val()+'" checked=checked> <label for="'+a(c).val()+'"><b>'+a(c).val()+"</b></label></li>")}),void b.home.add_existing_shows.loadContent())}),a("#rootDirStaticList").on("click",".dir_check",b.home.add_existing_shows.loadContent),a("#tableDiv").on("click",".showManage",function(b){b.preventDefault(),a("#tabs").tabs("option","active",0),a("html,body").animate({scrollTop:0},1e3)}),a("#rootDirs option").attr("selected","selected").parent().focus(),a("#rootDirs option").click()},loadContent:function(){var b="";a(".dir_check").each(function(c,d){a(d).is(":checked")&&(b.length&&(b+="&"),b+="rootDir="+encodeURIComponent(a(d).attr("id")))}),a("#tableDiv").html('<img id="searchingAnim" src="/images/loading32.gif" height="32" width="32" /> loading folders...'),a.get("/home/addShows/massAddTable/",b,function(b){a("#tableDiv").html(b),a("#addRootDirTable").tablesorter({sortList:[[1,0]],widgets:["zebra"],headers:{0:{sorter:!1}}})})}},postprocess:function(){a("#episodeDir").fileBrowser({title:"Select Unprocessed Episode Folder",key:"postprocessPath"})},trending_shows:{init:function(){a("#showsort").val("original"),a("#showsortdirection").val("asc");var c=[a("#container")];a.each(c,function(){a(this).isotope({itemSelector:".trakt_show",sortBy:"original-order",layoutMode:"fitRows",getSortData:{name:function(c){var d=a(c).attr("data-name")||"";return(b.metaToBool("sickrage.SORT_ARTICLE")?d:d.replace(/^(The|A|An)\s/i,"")).toLowerCase()},rating:"[data-rating] parseInt",votes:"[data-votes] parseInt"}})}),a("#showsort").on("change",function(){var b;switch(a(this).value){case"original":b="original-order";break;case"rating":a("#container").isotope({sortBy:"random"}),b="rating";break;case"rating_votes":b=["rating","votes"];break;case"votes":b="votes";break;default:b="name"}a("#container").isotope({sortBy:b})}),a("#showsortdirection").on("change",function(){a("#container").isotope({sortAscending:"asc"===a(this).value})}),a("#trendingShows").loadContent("/home/addShows/getTrendingShows/","Loading trending shows...","Trakt timed out, refresh page to try again"),a("#container").isotope({itemSelector:".trakt_show",layoutMode:"fitRows"})},loadContent:function(c,d,e){a(this).html('<img id="searchingAnim" src="/images/loading32'+b.themeSpinner+'.gif" height="32" width="32" />&nbsp;'+d),a(this).load(c+" #container",function(b,c){"error"===c&&a(this).empty().html(e)})}},recommended_shows:{init:function(){a("#tabs").tabs({collapsible:!0,selected:b.metaToBool("sickrage.SORT_ARTICLE")?-1:0}),a("#showsort").val("original"),a("#showsortdirection").val("asc");var c=[a("#container")];a.each(c,function(){a(this).isotope({itemSelector:".trakt_show",sortBy:"original-order",layoutMode:"fitRows",getSortData:{name:function(c){var d=a(c).attr("data-name");return b.metaToBool("sickrage.SORT_ARTICLE")?d||"":(d||"").replace(/^(The|A|An)\s/i,"")},rating:"[data-rating] parseInt",votes:"[data-votes] parseInt"}})}),a("#showsort").on("change",function(){var b;switch(a(this).value){case"original":b="original-order";break;case"rating":a("#container").isotope({sortBy:"random"}),b="rating";break;case"rating_votes":b=["rating","votes"];break;case"votes":b="votes";break;default:b="name"}a("#container").isotope({sortBy:b})}),a("#showsortdirection").on("change",function(){a("#container").isotope({sortAscending:"asc"===a(this).value})}),a("#recommendedShows").loadContent("/home/addShows/getRecommendedShows/","Loading recommended shows...","Trakt timed out, refresh page to try again"),a("#container").isotope({itemSelector:".trakt_show",layoutMode:"fitRows"})},loadContent:function(c,d,e){a(this).html('<img id="searchingAnim" src="/images/loading32'+b.themeSpinner+'.gif" height="32" width="32" />&nbsp;'+d),a(this).load(c+" #container",function(b,c){"error"===c&&a(this).empty().html(e)})}},popular_shows:function(){a("#popularShows:has(tbody tr)").tablesorter({sortList:[[2,1]]})},test_renaming:function(){a(".seriesCheck").on("click",function(){var b=this;a(".seasonCheck:visible").each(function(){a(this).prop("checked",b.checked)}),a(".epCheck:visible").each(function(){a(this).prop("checked",b.checked)})}),a(".seasonCheck").click(function(){var b=this,c=a(b).attr("id");a(".epCheck:visible").each(function(){var d=a(this).attr("id").split("x");d[0]===c&&a(this).prop("checked",b.checked)})}),a("input[type=submit]").on("click",function(){var b=[];return a(".epCheck").each(function(){a(this).prop("checked")&&b.push(a(this).attr("id"))}),0!==b.length&&void(window.location.href="/home/doRename?show="+a("#showID").attr("value")+"&eps="+b.join("|"))})},restart:function(){var c=setInterval(function(){a.ajax({url:"/home/is_alive/",dataType:"jsonp",jsonp:"srcallback",success:function(d){""!==b.srPID&&d.msg!==b.srPID||(a("#shut_down_loading").hide(),a("#shut_down_success").show(),clearInterval(c),a("#restart_loading").hide(),a("#restart_success").show(),setTimeout(function(){a("#refresh_message").show(),window.location="/"+b.srDefaultPage+"/"},25e3))},error:function(b){a("#restart_message").show()}})},100)},new_show:{init:function(){a("#addShowForm").steps({bodyTag:"section",transitionEffect:"fade",stepsOrientation:"vertical",onStepChanging:function(c,d,e){var f;return d>e||(b.home.add_show_options(),b.root_dirs.init(),b.quality_chooser.init(),f=a("input:radio[name=whichSeries]:checked").length?a("input:radio[name=whichSeries]:checked").val().split("|")[4]:a("input:hidden[name=whichSeries]").length&&a("input:hidden[name=whichSeries]").val().length?a("#providedName").val():"",f.length?(b.home.update_bwlist(f),!0):void 0)},onFinished:function(c,d){b.home.generate_bwlist(),a(this).submit()}}),a("input:hidden[name=whichSeries]").length&&a("#fullShowPath").length&&a("#addShowForm").steps("getStep","1"),a("#searchName").on("click",function(){a("#searchName").prop("disabled",!0),b.home.new_show.searchIndexers(),a("#searchName").prop("disabled",!1)}),a("#skipShowButton").on("click",function(){a("#skipShow").val("1"),a("#addShowForm").submit()}),a("#nameToSearch").focus(),a("#indexerLang").bfhlanguages({language:b.getMeta("sickrage.DEFAULT_LANGUAGE"),available:b.getMeta("sickrage.LANGUAGES")})},searchIndexers:function(){if(a("#nameToSearch").val().length){var c="<b>"+a("#nameToSearch").val().trim()+"</b> on "+a("#providedIndexer option:selected").text()+"<br/>";a("#messages").empty().html('<img id="searchingAnim" src="/images/loading32'+b.themeSpinner+'.gif" height="24" width="24" /> searching for '+c),a.ajax({url:"/home/addShows/searchIndexersForShowName",data:{search_term:a("#nameToSearch").val().trim(),lang:a("#indexerLang").val(),indexer:a("#providedIndexer").val()},timeout:1e3*parseInt(a("#indexer_timeout").val(),10),dataType:"json",error:function(){a("#messages").empty().html("search timed out, try again or try another indexer")},success:function(c){var d=!0,e='<legend class="legend">Search Results:</legend>\n',f="";0===c.results.length?e+="<b>No results found, try a different search or language.</b>":(a.each(c.results,function(a,g){d?(f=" checked",d=!1):f="";var h=g.join("|");if(e+='<input type="radio" class="pull-left" id="whichSeries" name="whichSeries" value="'+h.replace(/"/g,"")+'"'+f+" /> ",e+='<a href="'+b.anon_url(g[2]+g[3]+"&lid="+c.langid||7)+'" onclick="window.open(this.href, \'_blank\'); return false;" ><b>'+g[4]+"</b></a>",null!==g[5]){var i=new Date(g[5]),j=new Date;e+=i>j?" (will debut on "+g[5]+")":" (started on "+g[5]+")"}null!==g[0]&&(e+=" ["+g[0]+"]"),e+="<br/>"}),e+="</ul>"),e+="<br/>",a("#messages").html(e)}})}}},add_show_options:function(){a("#saveDefaultsButton").on("click",function(){var b=[],c=[];a("#anyQualities option:selected").each(function(c,d){b.push(a(d).val())}),a("#bestQualities option:selected").each(function(b,d){c.push(a(d).val())}),a.get("/config/general/saveAddShowDefaults",{defaultStatus:a("#statusSelect").val(),anyQualities:b.join(","),bestQualities:c.join(","),defaultFlattenFolders:a("#flatten_folders").prop("checked"),subtitles:a("#subtitles").prop("checked"),anime:a("#anime").prop("checked"),scene:a("#scene").prop("checked"),defaultStatusAfter:a("#statusSelectAfter").val(),archive:a("#archive").prop("checked")}),a(this).attr("disabled",!0),new PNotify({title:"Saved Defaults",text:'Your "add show" defaults have been set to your current selections.',shadow:!1})}),a("#statusSelect, #qualityPreset, #flatten_folders, #anyQualities, #bestQualities, #subtitles, #scene, #anime, #statusSelectAfter, #archive").change(function(){a("#saveDefaultsButton").attr("disabled",!1)})},generate_bwlist:function(){var b=[];a("#white option").each(function(c,d){b[c]=a(d).val()}),a("#whitelist").val(b.join(",")),b=[],a("#black option").each(function(c,d){b[c]=a(d).val()}),a("#blacklist").val(b.join(","))},update_bwlist:function(b){a("#white").children().remove(),a("#black").children().remove(),a("#pool").children().remove(),a("#anime").prop("checked")?(a("#blackwhitelist").show(),b&&a.getJSON("/home/fetch_releasegroups",{show_name:b},function(b){"success"===b.result&&a.each(b.groups,function(b,c){var d=a("<option>");d.attr("value",c.name),d.html(c.name+" | "+c.rating+" | "+c.range),d.appendTo("#pool")})})):a("#blackwhitelist").hide()}},config:{init:function(){a("#configForm").ajaxForm({beforeSubmit:function(){a(".config_submitter .config_submitter_refresh").each(function(){a(this).attr("disabled","disabled"),a(this).after("<span>"+b.loading+" Saving...</span>"),a(this).hide()})},success:function(){setTimeout(function(){"use strict";a(".config_submitter").each(function(){a(this).removeAttr("disabled"),a.next().remove(),a(this).show()}),a(".config_submitter_refresh").each(function(){a(this).removeAttr("disabled"),a.next().remove(),a(this).show(),window.location.reload()}),a("#email_show").trigger("notify")},2e3)}})},general:function(){0===a("input[name='proxy_setting']").val().length&&(a("input[id='proxy_indexers']").prop("checked",!1),a("label[for='proxy_indexers']").hide()),a("input[name='proxy_setting']").on("input",function(){0===a(this).val().length?(a("input[id='proxy_indexers']").prop("checked",!1),a("label[for='proxy_indexers']").hide()):a("label[for='proxy_indexers']").show()}),a("#log_dir").fileBrowser({title:"Select log file folder location"}),a(".enabler").each(function(){a(this).prop("checked")||a("#content_"+a(this).attr("id")).hide()}),a(".enabler").on("click",function(){a(this).prop("checked")?a("#content_"+a(this).attr("id")).fadeIn("fast","linear"):a("#content_"+a(this).attr("id")).fadeOut("fast","linear")}),a(".viewIf").on("click",function(){a(this).prop("checked")?(a(".hide_if_"+a(this).attr("id")).css("display","none"),a(".show_if_"+a(this).attr("id")).fadeIn("fast","linear")):(a(".show_if_"+a(this).attr("id")).css("display","none"),a(".hide_if_"+a(this).attr("id")).fadeIn("fast","linear"))}),a(".datePresets").on("click",function(){var b=a("#date_presets").val();a(this).prop("checked")&&"%x"===b?(b="%a, %b %d, %Y",a("#date_use_system_default").html("1")):a(this).prop("checked")||"1"!==a("#date_use_system_default").html()||(b="%x"),a("#date_presets").attr("name","date_preset_old"),a("#date_presets").attr("id","date_presets_old"),a("#date_presets_na").attr("name","date_preset"),a("#date_presets_na").attr("id","date_presets"),a("#date_presets_old").attr("name","date_preset_na"),a("#date_presets_old").attr("id","date_presets_na"),b&&a("#date_presets").val(b)}),a("#api_key").on("click",function(){a("#api_key").select()}),a("#generate_new_apikey").on("click",function(){a.get("/config/general/generateApiKey",function(b){return void 0!==b.error?void alert(b.error):void a("#api_key").val(b)})}),a("#branchCheckout").on("click",function(){window.location.href="/home/branchCheckout?branch="+a("#branchVersion").val()}),a("#google_link").on("click",function(){null===localStorage.getItem("google_token_type")||null===localStorage.getItem("google_access_token")?b.google.login():b.google.logout()}),null===localStorage.getItem("google_token_type")||null===localStorage.getItem("google_access_token")?a("#google_link").prop("value","Link"):a("#google_link").prop("value","Unlink")},subtitles:{init:function(){a("#subtitles_dir").fileBrowser({title:"Select Subtitles Download Directory"}),a("#editAService").change(function(){b.config.subtitles.showHideServices()}),a(".service_enabler").on("click",function(){b.config.subtitles.refreshServiceList()}),b.config.subtitles.showHideServices(),a("#service_order_list").sortable({placeholder:"ui-state-highlight",update:function(){b.config.subtitles.refreshServiceList()}}),a("#service_order_list").disableSelection()},showHideServices:function(){a(".serviceDiv").each(function(){var b=a(this).attr("id"),c=a("#editAService :selected").val();c+"Div"===b?a(this).show():a(this).hide()})},addService:function(c,d,e,f,g,h){if(null===e.match("/$")&&(e+="/"),0===a("#service_order_list > #"+c).length&&h!==!1){var i='<li class="ui-state-default" id="'+c+'"> <input type="checkbox" id="enable_'+c+'" class="service_enabler" CHECKED> <a href="'+b.anon_url(e)+'" class="imgLink" target="_new"><img src="/images/services/newznab.gif" alt="'+d+'" width="16" height="16"></a> '+d+"</li>";a("#service_order_list").append(i),a("#service_order_list").sortable("refresh")}},deleteService:function(b){a("#service_order_list > #"+b).remove()},refreshServiceList:function(){var b=a("#service_order_list").sortable("toArray"),c=[];a.each(b,function(b,d){var e=+a("#enable_"+d).prop("checked")?"1":"0";c.push(d+":"+e)}),a("#service_order").val(c.join(" "))}},search:{init:function(){a("#nzb_method").change(b.config.search.nzbMethodHandler),a("#torrent_method").change(b.config.search.torrentMethodHandler),b.config.search.nzbMethodHandler(),b.config.search.torrentMethodHandler(),a("#testSABnzbd").click(function(){a("#testSABnzbd_result").html(b.loading);var c=a("#sab_host").val(),d=a("#sab_username").val(),e=a("#sab_password").val(),f=a("#sab_apikey").val();a.get("/home/testSABnzbd",{host:c,username:d,password:e,apikey:f},function(b){a("#testSABnzbd_result").html(b)})}),a("#use_torrents").click(function(){b.config.search.toggleTorrentTitle()}),a("#test_torrent").click(function(){a("#test_torrent_result").html(b.loading);var c=a("#torrent_method :selected").val(),d=a("#torrent_host").val(),e=a("#torrent_username").val(),f=a("#torrent_password").val();a.get("/home/testTorrent",{torrent_method:c,host:d,username:e,password:f},function(b){a("#test_torrent_result").html(b)})}),a("#torrent_host").change(b.config.search.rtorrentScgi),a("#nzb_dir").fileBrowser({title:"Select .nzb blackhole/watch location"}),a("#torrent_dir").fileBrowser({title:"Select .torrent blackhole/watch location"}),a("#torrent_path").fileBrowser({title:"Select .torrent download location"})},toggleTorrentTitle:function(){a("#use_torrents").prop("checked")?a("#no_torrents").show():a("#no_torrents").hide()},nzbMethodHandler:function(){a("#blackhole_settings").hide(),a("#sabnzbd_settings").hide(),a("#testSABnzbd").hide(),a("#testSABnzbd_result").hide(),a("#nzbget_settings").hide(),"blackhole"===a("#nzb_method").val().toLowerCase()?a("#blackhole_settings").show():"nzbget"===a("#nzb_method").val().toLowerCase()?a("#nzbget_settings").show():(a("#sabnzbd_settings").show(),a("#testSABnzbd").show(),a("#testSABnzbd_result").show())},torrentMethodHandler:function(){a("#options_torrent_clients").hide(),a("#options_torrent_blackhole").hide();var b=a("#torrent_method").val(),c=" host:port",d=" username",e=" password",f="",g="#options_torrent_blackhole",h=" RPC URL";a("#torrent_method_icon").removeClass(function(a,b){return(b.match(/(^|\s)add-client-icon-\S+/g)||[]).join(" ")}),a("#torrent_method_icon").addClass("add-client-icon-"+b.replace("_","-")),"blackhole"!==b.toLowerCase()&&(a("#label_warning_deluge").hide(),a("#label_anime_warning_deluge").hide(),a("#host_desc_torrent").show(),a("#torrent_verify_cert_option").hide(),a("#torrent_verify_deluge").hide(),a("#torrent_verify_rtorrent").hide(),a("#torrent_auth_type_option").hide(),a("#torrent_path_option").show(),a("#torrent_path_option").find(".fileBrowser").show(),a("#torrent_seed_time_option").hide(),a("#torrent_high_bandwidth_option").hide(),a("#torrent_label_option").show(),a("#torrent_label_anime_option").show(),a("#path_synology").hide(),a("#torrent_paused_option").show(),a("#torrent_rpcurl_option").hide(),"utorrent"===b.toLowerCase()?(f="uTorrent",a("#torrent_path_option").hide(),a("#torrent_seed_time_label").text("Minimum seeding time is"),a("#torrent_seed_time_option").show(),a("#host_desc_torrent").text("URL to your uTorrent client (e.g. http://localhost:8000)")):"transmission"===b.toLowerCase()?(f="Transmission",a("#torrent_seed_time_label").text("Stop seeding when inactive for"),a("#torrent_seed_time_option").show(),a("#torrent_high_bandwidth_option").show(),a("#torrent_label_option").hide(),a("#torrent_label_anime_option").hide(),a("#torrent_rpcurl_option").show(),a("#host_desc_torrent").text("URL to your Transmission client (e.g. http://localhost:9091)")):"deluge"===b.toLowerCase()?(f="Deluge",a("#torrent_verify_cert_option").show(),a("#torrent_verify_deluge").show(),a("#torrent_verify_rtorrent").hide(),a("#label_warning_deluge").show(),a("#label_anime_warning_deluge").show(),a("#torrent_username_option").hide(),a("#torrent_username").prop("value",""),a("#host_desc_torrent").text("URL to your Deluge client (e.g. http://localhost:8112)")):"deluged"===b.toLowerCase()?(f="Deluge",a("#torrent_verify_cert_option").hide(),a("#torrent_verify_deluge").hide(),a("#torrent_verify_rtorrent").hide(),a("#label_warning_deluge").show(),a("#label_anime_warning_deluge").show(),a("#torrent_username_option").show(),a("#host_desc_torrent").text("IP or Hostname of your Deluge Daemon (e.g. scgi://localhost:58846)")):"download_station"===b.toLowerCase()?(f="Synology DS",a("#torrent_label_option").hide(),a("#torrent_label_anime_option").hide(),a("#torrent_paused_option").hide(),a("#torrent_path_option").find(".fileBrowser").hide(),a("#host_desc_torrent").text("URL to your Synology DS client (e.g. http://localhost:5000)"),a("#path_synology").show()):"rtorrent"===b.toLowerCase()?(f="rTorrent",a("#torrent_paused_option").hide(),a("#host_desc_torrent").text("URL to your rTorrent client (e.g. scgi://localhost:5000 <br> or https://localhost/rutorrent/plugins/httprpc/action.php)"),a("#torrent_verify_cert_option").show(),a("#torrent_verify_deluge").hide(),a("#torrent_verify_rtorrent").show(),a("#torrent_auth_type_option").show()):"qbittorrent"===b.toLowerCase()?(f="qbittorrent",a("#torrent_path_option").hide(),a("#label_warning_qbittorrent").show(),a("#label_anime_warning_qbittorrent").show(),a("#host_desc_torrent").text("URL to your qbittorrent client (e.g. http://localhost:8080)")):"mlnet"===b.toLowerCase()?(f="mlnet",a("#torrent_path_option").hide(),a("#torrent_label_option").hide(),a("#torrent_verify_cert_option").hide(),a("#torrent_verify_deluge").hide(),a("#torrent_verify_rtorrent").hide(),a("#torrent_label_anime_option").hide(),a("#torrent_paused_option").hide(),a("#host_desc_torrent").text("URL to your MLDonkey (e.g. http://localhost:4080)")):"putio"===b.toLowerCase()&&(f="putio",a("#torrent_path_option").hide(),a("#torrent_label_option").hide(),a("#torrent_verify_cert_option").hide(),a("#torrent_verify_deluge").hide(),a("#torrent_verify_rtorrent").hide(),a("#torrent_label_anime_option").hide(),a("#torrent_paused_option").hide(),a("#torrent_host_option").hide(),a("#host_desc_torrent").text("URL to your putio client (e.g. http://localhost:8080)")),a("#host_title").text(f+c),a("#username_title").text(f+d),a("#password_title").text(f+e),a("#torrent_client").text(f),a("#rpcurl_title").text(f+h),g="#options_torrent_clients"),a(g).show()},rtorrentScgi:function(){var b=a("#torrent_method :selected").val();if("rtorrent"===b.toLowerCase()){var c=a("#torrent_host").prop("value"),d="scgi://"===c.substr(0,7);d?(a("#torrent_username_option").hide(),a("#torrent_username").prop("value",""),a("#torrent_password_option").hide(),a("#torrent_password").prop("value",""),a("#torrent_auth_type_option").hide(),a("#torrent_auth_type option[value=none]").attr("selected","selected")):(a("#torrent_username_option").show(),a("#torrent_password_option").show(),a("#torrent_auth_type_option").show())}}},postprocessing:{init:function(){a("#unpack").on("change",function(){a(this).prop("checked")?b.config.postprocessing.israr_supported():a("#unpack").qtip("toggle",!1)}),a("#name_presets").on("change",function(){b.config.postprocessing.setup_naming()}),a("#name_abd_presets").on("change",function(){b.config.postprocessing.setup_abd_naming()}),a("#naming_custom_abd").on("change",function(){b.config.postprocessing.setup_abd_naming()}),a("#name_sports_presets").on("change",function(){b.config.postprocessing.setup_sports_naming()}),a("#naming_custom_sports").on("change",function(){b.config.postprocessing.setup_sports_naming()}),a("#name_anime_presets").on("change",function(){b.config.postprocessing.setup_anime_naming()}),a("#naming_custom_anime").on("change",function(){b.config.postprocessing.setup_anime_naming()}),a('input[name="naming_anime"]').on("click",function(){b.config.postprocessing.setup_anime_naming()}),a("#naming_multi_ep").change(b.config.postprocessing.fill_examples),a("#naming_pattern").focusout(b.config.postprocessing.fill_examples),a("#naming_pattern").keyup(function(){b.config.postprocessing.typewatch(function(){b.config.postprocessing.fill_examples()},500)}),a("#naming_anime_multi_ep").change(b.config.postprocessing.fill_anime_examples),a("#naming_anime_pattern").focusout(b.config.postprocessing.fill_anime_examples),a("#naming_anime_pattern").keyup(function(){b.config.postprocessing.typewatch(function(){b.config.postprocessing.fill_anime_examples()},500)}),a("#naming_abd_pattern").focusout(b.config.postprocessing.fill_examples),a("#naming_abd_pattern").keyup(function(){b.config.postprocessing.typewatch(function(){b.config.postprocessing.fill_abd_examples()},500)}),a("#naming_sports_pattern").focusout(b.config.postprocessing.fill_examples),a("#naming_sports_pattern").keyup(function(){b.config.postprocessing.typewatch(function(){b.config.postprocessing.fill_sports_examples()},500)}),a("#naming_anime_pattern").focusout(b.config.postprocessing.fill_examples),a("#naming_anime_pattern").keyup(function(){b.config.postprocessing.typewatch(function(){b.config.postprocessing.fill_anime_examples()},500)}),a("#show_naming_key").on("click",function(){a("#naming_key").toggle()}),a("#show_naming_abd_key").on("click",function(){a("#naming_abd_key").toggle()}),a("#show_naming_sports_key").on("click",function(){a("#naming_sports_key").toggle()}),a("#show_naming_anime_key").on("click",function(){a("#naming_anime_key").toggle()}),a("#do_custom").on("click",function(){a("#naming_pattern").val(a("#name_presets :selected").attr("id")),a("#naming_custom").show(),a("#naming_pattern").focus()}),b.config.postprocessing.setup_naming(),b.config.postprocessing.setup_abd_naming(),b.config.postprocessing.setup_sports_naming(),b.config.postprocessing.setup_anime_naming(),a("#metadataType").on("change keyup",function(){b.config.postprocessing.showHideMetadata()}),b.config.postprocessing.showHideMetadata(),a(".metadata_checkbox").on("click",function(){b.config.postprocessing.refreshMetadataConfig(!1)}),b.config.postprocessing.refreshMetadataConfig(!0),a("img[title]").qtip({position:{viewport:a(window),at:"bottom center",my:"top right"},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-shadow qtip-dark"}}),a("i[title]").qtip({position:{viewport:a(window),at:"top center",my:"bottom center"},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}}),a(".custom-pattern,#unpack").qtip({content:"validating...",show:{event:!1,ready:!1},hide:!1,position:{viewport:a(window),at:"center left",my:"center right"},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow qtip-red"}}),a("#tv_download_dir").fileBrowser({title:"Select TV Download Directory"})},typewatch:function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}},israr_supported:function(){a.get("/config/postProcessing/isRarSupported",function(b){"supported"!==b&&(a("#unpack").qtip("option",{"content.text":"Unrar Executable not found.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),a("#unpack").qtip("toggle",!0),a("#unpack").css("background-color","#FFFFDD"))})},fill_examples:function(){var b=a("#naming_pattern").val(),c=a("#naming_multi_ep :selected").val(),d=a('input[name="naming_anime"]:checked').val();a.get("/config/postProcessing/testNaming",{pattern:b,anime_type:3},function(b){b?(a("#naming_example").text(b+".ext"),a("#naming_example_div").show()):a("#naming_example_div").hide()}),a.get("/config/postProcessing/testNaming",{pattern:b,multi:c,anime_type:3},function(b){b?(a("#naming_example_multi").text(b+".ext"),a("#naming_example_multi_div").show()):a("#naming_example_multi_div").hide()}),a.get("/config/postProcessing/isNamingValid",{pattern:b,multi:c,anime_type:d},function(b){"invalid"===b?(a("#naming_pattern").qtip("option",{"content.text":"This pattern is invalid.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),a("#naming_pattern").qtip("toggle",!0),a("#naming_pattern").css("background-color","#FFDDDD")):"seasonfolders"===b?(a("#naming_pattern").qtip("option",{"content.text":'This pattern would be invalid without the folders, using it will force "Flatten" off for all shows.',"style.classes":"qtip-rounded qtip-shadow qtip-red"}),a("#naming_pattern").qtip("toggle",!0),a("#naming_pattern").css("background-color","#FFFFDD")):(a("#naming_pattern").qtip("option",{"content.text":"This pattern is valid.","style.classes":"qtip-rounded qtip-shadow qtip-green"}),a("#naming_pattern").qtip("toggle",!1),a("#naming_pattern").css("background-color","#FFFFFF"))})},fill_abd_examples:function(){var b=a("#naming_abd_pattern").val();a.get("/config/postProcessing/testNaming",{pattern:b,abd:"True"},function(b){b?(a("#naming_abd_example").text(b+".ext"),a("#naming_abd_example_div").show()):a("#naming_abd_example_div").hide()}),a.get("/config/postProcessing/isNamingValid",{pattern:b,abd:"True"},function(b){"invalid"===b?(a("#naming_abd_pattern").qtip("option",{"content.text":"This pattern is invalid.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),a("#naming_abd_pattern").qtip("toggle",!0),a("#naming_abd_pattern").css("background-color","#FFDDDD")):"seasonfolders"===b?(a("#naming_abd_pattern").qtip("option",{"content.text":'This pattern would be invalid without the folders, using it will force "Flatten" off for all shows.',"style.classes":"qtip-rounded qtip-shadow qtip-red"}),a("#naming_abd_pattern").qtip("toggle",!0),a("#naming_abd_pattern").css("background-color","#FFFFDD")):(a("#naming_abd_pattern").qtip("option",{
"content.text":"This pattern is valid.","style.classes":"qtip-rounded qtip-shadow qtip-green"}),a("#naming_abd_pattern").qtip("toggle",!1),a("#naming_abd_pattern").css("background-color","#FFFFFF"))})},fill_sports_examples:function(){var b=a("#naming_sports_pattern").val();a.get("/config/postProcessing/testNaming",{pattern:b,sports:"True"},function(b){b?(a("#naming_sports_example").text(b+".ext"),a("#naming_sports_example_div").show()):a("#naming_sports_example_div").hide()}),a.get("/config/postProcessing/isNamingValid",{pattern:b,sports:"True"},function(b){"invalid"===b?(a("#naming_sports_pattern").qtip("option",{"content.text":"This pattern is invalid.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),a("#naming_sports_pattern").qtip("toggle",!0),a("#naming_sports_pattern").css("background-color","#FFDDDD")):"seasonfolders"===b?(a("#naming_sports_pattern").qtip("option",{"content.text":'This pattern would be invalid without the folders, using it will force "Flatten" off for all shows.',"style.classes":"qtip-rounded qtip-shadow qtip-red"}),a("#naming_sports_pattern").qtip("toggle",!0),a("#naming_sports_pattern").css("background-color","#FFFFDD")):(a("#naming_sports_pattern").qtip("option",{"content.text":"This pattern is valid.","style.classes":"qtip-rounded qtip-shadow qtip-green"}),a("#naming_sports_pattern").qtip("toggle",!1),a("#naming_sports_pattern").css("background-color","#FFFFFF"))})},fill_anime_examples:function(){var b=a("#naming_anime_pattern").val(),c=a("#naming_anime_multi_ep :selected").val(),d=a('input[name="naming_anime"]:checked').val();a.get("/config/postProcessing/testNaming",{pattern:b,anime_type:d},function(b){b?(a("#naming_example_anime").text(b+".ext"),a("#naming_example_anime_div").show()):a("#naming_example_anime_div").hide()}),a.get("/config/postProcessing/testNaming",{pattern:b,multi:c,anime_type:d},function(b){b?(a("#naming_example_multi_anime").text(b+".ext"),a("#naming_example_multi_anime_div").show()):a("#naming_example_multi_anime_div").hide()}),a.get("/config/postProcessing/isNamingValid",{pattern:b,multi:c,anime_type:d},function(b){"invalid"===b?(a("#naming_pattern").qtip("option",{"content.text":"This pattern is invalid.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),a("#naming_pattern").qtip("toggle",!0),a("#naming_pattern").css("background-color","#FFDDDD")):"seasonfolders"===b?(a("#naming_pattern").qtip("option",{"content.text":'This pattern would be invalid without the folders, using it will force "Flatten" off for all shows.',"style.classes":"qtip-rounded qtip-shadow qtip-red"}),a("#naming_pattern").qtip("toggle",!0),a("#naming_pattern").css("background-color","#FFFFDD")):(a("#naming_pattern").qtip("option",{"content.text":"This pattern is valid.","style.classes":"qtip-rounded qtip-shadow qtip-green"}),a("#naming_pattern").qtip("toggle",!1),a("#naming_pattern").css("background-color","#FFFFFF"))})},setup_naming:function(){"Custom..."===a("#name_presets :selected").val()?a("#naming_custom").show():(a("#naming_custom").hide(),a("#naming_pattern").val(a("#name_presets :selected").attr("id"))),b.config.postprocessing.fill_examples()},setup_abd_naming:function(){"Custom..."===a("#name_abd_presets :selected").val()?a("#naming_abd_custom").show():(a("#naming_abd_custom").hide(),a("#naming_abd_pattern").val(a("#name_abd_presets :selected").attr("id"))),b.config.postprocessing.fill_abd_examples()},setup_sports_naming:function(){"Custom..."===a("#name_sports_presets :selected").val()?a("#naming_sports_custom").show():(a("#naming_sports_custom").hide(),a("#naming_sports_pattern").val(a("#name_sports_presets :selected").attr("id"))),b.config.postprocessing.fill_sports_examples()},setup_anime_naming:function(){"Custom..."===a("#name_anime_presets :selected").val()?a("#naming_anime_custom").show():(a("#naming_anime_custom").hide(),a("#naming_anime_pattern").val(a("#name_anime_presets :selected").attr("id"))),b.config.postprocessing.fill_anime_examples()},showHideMetadata:function(){a(".metadataDiv").each(function(){var b=a(this).attr("id"),c=a("#metadataType :selected").val();c===b?a(this).show():a(this).hide()})},refreshMetadataConfig:function(c){var d=0,e="";a(".metadataDiv").each(function(){var b=a(this).attr("id"),c=[],f=a("#"+b+"_show_metadata").prop("checked"),g=a("#"+b+"_episode_metadata").prop("checked"),h=a("#"+b+"_fanart").prop("checked"),i=a("#"+b+"_poster").prop("checked"),j=a("#"+b+"_banner").prop("checked"),k=a("#"+b+"_episode_thumbnails").prop("checked"),l=a("#"+b+"_season_posters").prop("checked"),m=a("#"+b+"_season_banners").prop("checked"),n=a("#"+b+"_season_all_poster").prop("checked"),o=a("#"+b+"_season_all_banner").prop("checked"),p=a("#"+b+"_enabled").prop("checked");c.push(f?"1":"0"),c.push(g?"1":"0"),c.push(h?"1":"0"),c.push(i?"1":"0"),c.push(j?"1":"0"),c.push(k?"1":"0"),c.push(l?"1":"0"),c.push(m?"1":"0"),c.push(n?"1":"0"),c.push(o?"1":"0"),c.push(p?"1":"0");for(var q=0,r=0;r<c.length;r++)q+=parseInt(c[r]);q>d&&(d=q,e=b),a("#"+b+"_eg_show_metadata").attr("class",f?"enabled":"disabled"),a("#"+b+"_eg_episode_metadata").attr("class",g?"enabled":"disabled"),a("#"+b+"_eg_fanart").attr("class",h?"enabled":"disabled"),a("#"+b+"_eg_poster").attr("class",i?"enabled":"disabled"),a("#"+b+"_eg_banner").attr("class",j?"enabled":"disabled"),a("#"+b+"_eg_episode_thumbnails").attr("class",k?"enabled":"disabled"),a("#"+b+"_eg_season_posters").attr("class",l?"enabled":"disabled"),a("#"+b+"_eg_season_banners").attr("class",m?"enabled":"disabled"),a("#"+b+"_eg_season_all_poster").attr("class",n?"enabled":"disabled"),a("#"+b+"_eg_season_all_banner").attr("class",o?"enabled":"disabled"),a("#"+b+"_data").val(c.join("|"))}),""!==e&&c&&(a("#metadataType option[value="+e+"]").attr("selected","selected"),b.config.postprocessing.showHideMetadata())}},notifications:{init:function(){a("#testGrowl").click(function(){var c=a.trim(a("#growl_host").val()),d=a.trim(a("#growl_password").val());return c?(a("#growl_host").removeClass("warning"),a(this).prop("disabled",!0),a("#testGrowl-result").html(b.loading),void a.get("/home/testGrowl",{host:c,password:d}).done(function(b){a("#testGrowl-result").html(b),a("#testGrowl").prop("disabled",!1)})):(a("#testGrowl-result").html("Please fill out the necessary fields above."),void a("#growl_host").addClass("warning"))}),a("#testProwl").click(function(){var c=a.trim(a("#prowl_api").val()),d=a("#prowl_priority").val();return c?(a("#prowl_api").removeClass("warning"),a(this).prop("disabled",!0),a("#testProwl-result").html(b.loading),void a.get("/home/testProwl",{prowl_api:c,prowl_priority:d}).done(function(b){a("#testProwl-result").html(b),a("#testProwl").prop("disabled",!1)})):(a("#testProwl-result").html("Please fill out the necessary fields above."),void a("#prowl_api").addClass("warning"))}),a("#testKODI").click(function(){var c=a.trim(a("#kodi_host").val()),d=a.trim(a("#kodi_username").val()),e=a.trim(a("#kodi_password").val());return c?(a("#kodi_host").removeClass("warning"),a(this).prop("disabled",!0),a("#testKODI-result").html(b.loading),void a.get("/home/testKODI",{host:c,username:d,password:e}).done(function(b){a("#testKODI-result").html(b),a("#testKODI").prop("disabled",!1)})):(a("#testKODI-result").html("Please fill out the necessary fields above."),void a("#kodi_host").addClass("warning"))}),a("#testPMC").click(function(){var c=a.trim(a("#plex_host").val()),d=a.trim(a("#plex_client_username").val()),e=a.trim(a("#plex_client_password").val());return c?(a("#plex_host").removeClass("warning"),a(this).prop("disabled",!0),a("#testPMC-result").html(b.loading),void a.get("/home/testPMC",{host:c,username:d,password:e}).done(function(b){a("#testPMC-result").html(b),a("#testPMC").prop("disabled",!1)})):(a("#testPMC-result").html("Please fill out the necessary fields above."),void a("#plex_host").addClass("warning"))}),a("#testPMS").click(function(){var c=a.trim(a("#plex_server_host").val()),d=a.trim(a("#plex_username").val()),e=a.trim(a("#plex_password").val()),f=a.trim(a("#plex_server_token").val());return c?(a("#plex_server_host").removeClass("warning"),a(this).prop("disabled",!0),a("#testPMS-result").html(b.loading),void a.get("/home/testPMS",{host:c,username:d,password:e,plex_server_token:f}).done(function(b){a("#testPMS-result").html(b),a("#testPMS").prop("disabled",!1)})):(a("#testPMS-result").html("Please fill out the necessary fields above."),void a("#plex_server_host").addClass("warning"))}),a("#testEMBY").click(function(){var c=a("#emby_host").val(),d=a("#emby_apikey").val();return c&&d?(a("#emby_host,#emby_apikey").removeClass("warning"),a(this).prop("disabled",!0),a("#testEMBY-result").html(b.loading),void a.get("/home/testEMBY",{host:c,emby_apikey:d}).done(function(b){a("#testEMBY-result").html(b),a("#testEMBY").prop("disabled",!1)})):(a("#testEMBY-result").html("Please fill out the necessary fields above."),c?a("#emby_host").removeClass("warning"):a("#emby_host").addClass("warning"),void(d?a("#emby_apikey").removeClass("warning"):a("#emby_apikey").addClass("warning")))}),a("#testBoxcar").click(function(){var c=a.trim(a("#boxcar_username").val());return c?(a("#boxcar_username").removeClass("warning"),a(this).prop("disabled",!0),a("#testBoxcar-result").html(b.loading),void a.get("/home/testBoxcar",{username:c}).done(function(b){a("#testBoxcar-result").html(b),a("#testBoxcar").prop("disabled",!1)})):(a("#testBoxcar-result").html("Please fill out the necessary fields above."),void a("#boxcar_username").addClass("warning"))}),a("#testBoxcar2").click(function(){var c=a.trim(a("#boxcar2_accesstoken").val());return c?(a("#boxcar2_accesstoken").removeClass("warning"),a(this).prop("disabled",!0),a("#testBoxcar2-result").html(b.loading),void a.get("/home/testBoxcar2",{accesstoken:c}).done(function(b){a("#testBoxcar2-result").html(b),a("#testBoxcar2").prop("disabled",!1)})):(a("#testBoxcar2-result").html("Please fill out the necessary fields above."),void a("#boxcar2_accesstoken").addClass("warning"))}),a("#testPushover").click(function(){var c=a("#pushover_userkey").val(),d=a("#pushover_apikey").val();return c&&d?(a("#pushover_userkey,#pushover_apikey").removeClass("warning"),a(this).prop("disabled",!0),a("#testPushover-result").html(b.loading),void a.get("/home/testPushover",{userKey:c,apiKey:d}).done(function(b){a("#testPushover-result").html(b),a("#testPushover").prop("disabled",!1)})):(a("#testPushover-result").html("Please fill out the necessary fields above."),c?a("#pushover_userkey").removeClass("warning"):a("#pushover_userkey").addClass("warning"),void(d?a("#pushover_apikey").removeClass("warning"):a("#pushover_apikey").addClass("warning")))}),a("#testLibnotify").click(function(){a("#testLibnotify-result").html(b.loading),a.get("/home/testLibnotify",function(b){a("#testLibnotify-result").html(b)})}),a("#twitterStep1").click(function(){a("#testTwitter-result").html(b.loading),a.get("/home/twitterStep1",function(a){window.open(a)}).done(function(){a("#testTwitter-result").html("<b>Step1:</b> Confirm Authorization")})}),a("#twitterStep2").click(function(){var c=a.trim(a("#twitter_key").val());return c?(a("#twitter_key").removeClass("warning"),a("#testTwitter-result").html(b.loading),void a.get("/home/twitterStep2",{key:c},function(b){a("#testTwitter-result").html(b)})):(a("#testTwitter-result").html("Please fill out the necessary fields above."),void a("#twitter_key").addClass("warning"))}),a("#testTwitter").click(function(){a.get("/home/testTwitter",function(b){a("#testTwitter-result").html(b)})}),a("#settingsNMJ").click(function(){if(!a("#nmj_host").val())return alert("Please fill in the Popcorn IP address"),void a("#nmj_host").focus();a("#testNMJ-result").html(b.loading);var c=a("#nmj_host").val();a.get("/home/settingsNMJ",{host:c},function(b){null===b&&(a("#nmj_database").removeAttr("readonly"),a("#nmj_mount").removeAttr("readonly"));var c=a.parseJSON(b);a("#testNMJ-result").html(c.message),a("#nmj_database").val(c.database),a("#nmj_mount").val(c.mount),c.database?a("#nmj_database").attr("readonly",!0):a("#nmj_database").removeAttr("readonly"),c.mount?a("#nmj_mount").attr("readonly",!0):a("#nmj_mount").removeAttr("readonly")})}),a("#testNMJ").click(function(){var c=a.trim(a("#nmj_host").val()),d=a("#nmj_database").val(),e=a("#nmj_mount").val();return c?(a("#nmj_host").removeClass("warning"),a(this).prop("disabled",!0),a("#testNMJ-result").html(b.loading),void a.get("/home/testNMJ",{host:c,database:d,mount:e}).done(function(b){a("#testNMJ-result").html(b),a("#testNMJ").prop("disabled",!1)})):(a("#testNMJ-result").html("Please fill out the necessary fields above."),void a("#nmj_host").addClass("warning"))}),a("#settingsNMJv2").click(function(){if(!a("#nmjv2_host").val())return alert("Please fill in the Popcorn IP address"),void a("#nmjv2_host").focus();a("#testNMJv2-result").html(b.loading);for(var c,d=a("#nmjv2_host").val(),e=document.getElementsByName("nmjv2_dbloc"),f=0;f<e.length;f++)if(e[f].checked){c=e[f].value;break}var g=a("#NMJv2db_instance").val();a.get("/home/settingsNMJv2",{host:d,dbloc:c,instance:g},function(b){null===b&&a("#nmjv2_database").removeAttr("readonly");var c=a.parseJSON(b);a("#testNMJv2-result").html(c.message),a("#nmjv2_database").val(c.database),c.database?a("#nmjv2_database").attr("readonly",!0):a("#nmjv2_database").removeAttr("readonly")})}),a("#testNMJv2").click(function(){var c=a.trim(a("#nmjv2_host").val());return c?(a("#nmjv2_host").removeClass("warning"),a(this).prop("disabled",!0),a("#testNMJv2-result").html(b.loading),void a.get("/home/testNMJv2",{host:c}).done(function(b){a("#testNMJv2-result").html(b),a("#testNMJv2").prop("disabled",!1)})):(a("#testNMJv2-result").html("Please fill out the necessary fields above."),void a("#nmjv2_host").addClass("warning"))}),a("#testFreeMobile").click(function(){var c=a.trim(a("#freemobile_id").val()),d=a.trim(a("#freemobile_apikey").val());return c&&d?(a("#freemobile_id,#freemobile_apikey").removeClass("warning"),a(this).prop("disabled",!0),a("#testFreeMobile-result").html(b.loading),void a.get("/home/testFreeMobile",{freemobile_id:c,freemobile_apikey:d}).done(function(b){a("#testFreeMobile-result").html(b),a("#testFreeMobile").prop("disabled",!1)})):(a("#testFreeMobile-result").html("Please fill out the necessary fields above."),c?a("#freemobile_id").removeClass("warning"):a("#freemobile_id").addClass("warning"),void(d?a("#freemobile_apikey").removeClass("warning"):a("#freemobile_apikey").addClass("warning")))}),a("#TraktGetPin").click(function(){var b=a("#trakt_pin_url").val();window.open(b,"popUp","toolbar=no, scrollbars=no, resizable=no, top=200, left=200, width=650, height=550"),a("#trakt_pin").removeClass("hide")}),a("#trakt_pin").on("keyup change",function(){var b=a("#trakt_pin").val();0!==b.length?(a("#TraktGetPin").addClass("hide"),a("#authTrakt").removeClass("hide")):(a("#TraktGetPin").removeClass("hide"),a("#authTrakt").addClass("hide"))}),a("#authTrakt").click(function(){var b=a("#trakt_pin").val();0!==b.length&&a.get("/home/getTraktToken",{trakt_pin:b}).done(function(b){a("#testTrakt-result").html(b),a("#authTrakt").addClass("hide"),a("#trakt_pin").addClass("hide"),a("#TraktGetPin").addClass("hide")})}),a("#testTrakt").click(function(){var c=a.trim(a("#trakt_username").val()),d=a.trim(a("#trakt_blacklist_name").val());return c?/\s/g.test(d)?(a("#testTrakt-result").html("Check blacklist name; the value need to be a trakt slug"),void a("#trakt_blacklist_name").addClass("warning")):(a("#trakt_username").removeClass("warning"),a("#trakt_blacklist_name").removeClass("warning"),a(this).prop("disabled",!0),a("#testTrakt-result").html(b.loading),void a.get("/home/testTrakt",{username:c,blacklist_name:d}).done(function(b){a("#testTrakt-result").html(b),a("#testTrakt").prop("disabled",!1)})):(a("#testTrakt-result").html("Please fill out the necessary fields above."),void(c?a("#trakt_username").removeClass("warning"):a("#trakt_username").addClass("warning")))}),a("#testEmail").click(function(){var c,d,e,f,g,h,i,j,k;c=a("#testEmail-result"),c.html(b.loading),d=a("#email_host").val(),d=d.length>0?d:null,e=a("#email_port").val(),e=e.length>0?e:null,f=a("#email_tls").prop("checked"),g=a("#email_from").val(),g=g.length>0?g:"root@localhost",h=a("#email_user").val().trim(),i=a("#email_password").val(),j="",null===d&&(j+='<li style="color: red;">You must specify an SMTP hostname!</li>'),null===e?j+='<li style="color: red;">You must specify an SMTP port!</li>':(null===e.match(/^\d+$/)||parseInt(e,10)>65535)&&(j+='<li style="color: red;">SMTP port must be between 0 and 65535!</li>'),j.length>0?(j="<ol>"+j+"</ol>",c.html(j)):(k=prompt("Enter an email address to send the test to:",null),null===k||0===k.length||null===k.match(/.*@.*/)?c.html('<p style="color: red;">You must provide a recipient email address!</p>'):a.get("/home/testEmail",{host:d,port:e,smtp_from:g,use_tls:f,user:h,pwd:i,to:k},function(b){a("#testEmail-result").html(b)}))}),a("#testNMA").click(function(){var c=a.trim(a("#nma_api").val()),d=a("#nma_priority").val();return c?(a("#nma_api").removeClass("warning"),a(this).prop("disabled",!0),a("#testNMA-result").html(b.loading),void a.get("/home/testNMA",{nma_api:c,nma_priority:d}).done(function(b){a("#testNMA-result").html(b),a("#testNMA").prop("disabled",!1)})):(a("#testNMA-result").html("Please fill out the necessary fields above."),void a("#nma_api").addClass("warning"))}),a("#testPushalot").click(function(){var c=a.trim(a("#pushalot_authorizationtoken").val());return c?(a("#pushalot_authorizationtoken").removeClass("warning"),a(this).prop("disabled",!0),a("#testPushalot-result").html(b.loading),void a.get("/home/testPushalot",{authorizationToken:c}).done(function(b){a("#testPushalot-result").html(b),a("#testPushalot").prop("disabled",!1)})):(a("#testPushalot-result").html("Please fill out the necessary fields above."),void a("#pushalot_authorizationtoken").addClass("warning"))}),a("#testPushbullet").click(function(){var c=a.trim(a("#pushbullet_api").val());return c?(a("#pushbullet_api").removeClass("warning"),a(this).prop("disabled",!0),a("#testPushbullet-result").html(b.loading),void a.get("/home/testPushbullet",{api:c}).done(function(b){a("#testPushbullet-result").html(b),a("#testPushbullet").prop("disabled",!1)})):(a("#testPushbullet-result").html("Please fill out the necessary fields above."),void a("#pushbullet_api").addClass("warning"))}),a("#getPushbulletDevices").click(function(){b.config.notifications.get_pushbullet_devices("Device list updated. Please choose a device to push to.")}),b.config.notifications.get_pushbullet_devices(),a("#email_show").on("change",function(){var b=parseInt(a("#email_show").val(),10);a.getJSON("/home/loadShowNotifyLists",function(c){c._size>0&&a("#email_show_list").val(b>=0?c[b.toString()].list:"")})}),a("#prowl_show").on("change",function(){var b=parseInt(a("#prowl_show").val(),10);a.getJSON("/home/loadShowNotifyLists",function(c){c._size>0&&a("#prowl_show_list").val(b>=0?c[b.toString()].prowl_notify_list:"")})}),b.config.notifications.load_show_notify_lists(),a("#email_show_save").click(function(){a.post("/home/saveShowNotifyList",{show:a("#email_show").val(),emails:a("#email_show_list").val()},function(){b.config.notifications.load_show_notify_lists()})}),a("#use_plex").click(function(){a(this).is(":checked")?a(".plexinfo").removeClass("hide"):a(".plexinfo").addClass("hide")})},get_pushbullet_devices:function(c){c&&a("#testPushbullet-result").html(b.loading);var d=a("#pushbullet_api").val();return d?(a.get("/home/getPushbulletDevices",{api:d},function(b){var d=a.parseJSON(b).devices,e=a("#pushbullet_device").val();a("#pushbullet_device_list").html("");for(var f=0;f<d.length;f++)d[f].active===!0&&(e===d[f].iden?a("#pushbullet_device_list").append('<option value="'+d[f].iden+'" selected>'+d[f].nickname+"</option>"):a("#pushbullet_device_list").append('<option value="'+d[f].iden+'">'+d[f].nickname+"</option>"));""===e?a("#pushbullet_device_list").prepend('<option value="" selected>All devices</option>'):a("#pushbullet_device_list").prepend('<option value="">All devices</option>'),c&&a("#testPushbullet-result").html(c)}),void a("#pushbullet_device_list").change(function(){a("#pushbullet_device").val(a("#pushbullet_device_list").val()),a("#testPushbullet-result").html("Don't forget to save your new pushbullet settings.")})):(a("#testPushbullet-result").html("You didn't supply a Pushbullet api key"),a("#pushbullet_api").focus(),!1)},load_show_notify_lists:function(){a.getJSON("/home/loadShowNotifyLists",function(b){var c,d;if(0!==b._size){var e=[];for(d in b)b.hasOwnProperty(d)&&"_"!==d.charAt(0)&&e.push(b[d]);var f=e.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0});c='<option value="-1">-- Select --</option>';for(d in f)f.hasOwnProperty(d)&&f[d].id&&f[d].name&&(c+='<option value="'+f[d].id+'">'+a("<div/>").text(f[d].name).html()+"</option>");a("#email_show").html(c),a("#email_show_list").val(""),a("#prowl_show").html(c),a("#prowl_show_list").val("")}})}},backup_restore:function(){a("#Backup").click(function(){a("#Backup").attr("disabled",!0),a("#Backup-result").html(b.loading);var c=a("#backupDir").val();a.get("/config/backuprestore/backup",{backupDir:c}).done(function(b){a("#Backup-result").html(b),a("#Backup").attr("disabled",!1)})}),a("#Restore").click(function(){a("#Restore").attr("disabled",!0),a("#Restore-result").html(b.loading);var c=a("#backupFile").val();a.get("/config/backuprestore/restore",{backupFile:c}).done(function(b){a("#Restore-result").html(b),a("#Restore").attr("disabled",!1)})}),a("#backupDir").fileBrowser({title:"Select backup folder to save to",key:"backupPath"}),a("#backupFile").fileBrowser({title:"Select backup files to restore",key:"backupFile",includeFiles:1})},providers:{newznabProviders:[],torrentRssProviders:[],newznabProvidersCapabilities:[],init:function(){a(document).on("change",".newznab_key",function(){var c=a(this).attr("id");c=c.substring(0,c.length-"_key".length);var d=a("#"+c+"_url").val(),e=a("#"+c+"_cat").val(),f=a(this).val();b.config.providers.updateNewznabProvider(c,d,f,e)}),a("#newznab_key,#newznab_url").change(function(){var c=a("#editANewznabProvider :selected").val();if("addNewznab"!==c){var d=a("#newznab_url").val(),e=a("#newznab_key").val(),f=a("#newznab_cat option").map(function(b,c){return a(c).text()}).toArray().join(",");b.config.providers.updateNewznabProvider(c,d,e,f)}}),a("#torrentrss_url,#torrentrss_cookies,#torrentrss_titleTAG").change(function(){var c=a("#editATorrentRssProvider :selected").val();if("addTorrentRss"!==c){var d=a("#torrentrss_url").val(),e=a("#torrentrss_cookies").val(),f=a("#torrentrss_titleTAG").val();b.config.providers.updateTorrentRssProvider(c,d,e,f)}}),a(document).on("change","#editAProvider",function(){b.config.providers.showHideProviders()}),a("#editANewznabProvider").change(function(){b.config.providers.populateNewznabSection()}),a("#editATorrentRssProvider").change(function(){b.config.providers.populateTorrentRssSection()}),a(document).on("click",".provider_enabler",function(){b.config.providers.refreshProviderList()}),a("#newznab_cat_update").click(function(){a("#newznab_cat option").each(function(){a(this).remove()});var c=[];a("#newznab_cap option:selected").each(function(){var b=a(this).val();c.push({text:b,value:b})}),b.config.providers.replaceProviderOptions("#newznab_cat",c);var d=a("#editANewznabProvider :selected").val();if("addNewznab"!==d){var e=a("#newznab_url").val(),f=a("#newznab_key").val(),g=a("#newznab_cat option").map(function(b,c){return a(c).text()}).toArray().join(",");a("#newznab_cat option:not([value])").remove(),b.config.providers.updateNewznabProvider(d,e,f,g)}}),a("#newznab_add").click(function(){var c=a.trim(a("#newznab_name").val()),d=a.trim(a("#newznab_url").val()),e=a.trim(a("#newznab_key").val()),f=a.trim(a("#newznab_cat option").map(function(b,c){return a(c).text()}).toArray().join(","));if(c&&d&&e){var g={name:c};a.getJSON("/config/providers/canAddNewznabProvider",g,function(a){return void 0!==a.error?void alert(a.error):(b.config.providers.addNewznabProvider(a.success,c,d,e,f,"false"),void b.config.providers.refreshEditAProvider())})}}),a(".newznab_delete").click(function(){var c=a("#editANewznabProvider :selected").val();b.config.providers.deleteNewznabProvider(c)}),a("#torrentrss_add").click(function(){var c=a("#torrentrss_name").val(),d=a("#torrentrss_url").val(),e=a("#torrentrss_cookies").val(),f=a("#torrentrss_titleTAG").val(),g={name:c,url:d,cookies:e,titleTAG:f};a.getJSON("/config/providers/canAddTorrentRssProvider",g,function(a){return void 0!==a.error?void alert(a.error):(b.config.providers.addTorrentRssProvider(a.success,c,d,e,f,"false"),void b.config.providers.refreshEditAProvider())})}),a(".torrentrss_delete").on("click",function(){b.config.providers.deleteTorrentRssProvider(a("#editATorrentRssProvider :selected").val()),b.config.providers.refreshEditAProvider()}),a(document).on("change","[class='providerDiv_tip'] input",function(){a("div .providerDiv [name="+a(this).attr("name")+"]").replaceWith(a(this).clone()),a("div .providerDiv [newznab_name="+a(this).attr("id")+"]").replaceWith(a(this).clone())}),a(document).on("change","[class='providerDiv_tip'] select",function(){a(this).find("option").each(function(){a(this).is(":selected")?a(this).prop("defaultSelected",!0):a(this).prop("defaultSelected",!1)}),a("div .providerDiv [name="+a(this).attr("name")+"]").empty().replaceWith(a(this).clone())}),a(document).on("change",".enabler",function(){a(this).is(":checked")?a(".content_"+a(this).attr("id")).each(function(){a(this).show()}):a(".content_"+a(this).attr("id")).each(function(){a(this).hide()})}),a(".enabler").each(function(){a(this).is(":checked")?a(".content_"+a(this).attr("id")).show():a(".content_"+a(this).attr("id")).hide()}),a(document).on("change",".seed_option",function(){var c=a(this).attr("id").split("_")[0];b.config.providers.makeTorrentOptionString(c)}),a("#provider_order_list").sortable({placeholder:"ui-state-highlight",update:function(){b.config.providers.refreshProviderList()}}),a("#provider_order_list").disableSelection(),a("#editANewznabProvider").length&&b.config.providers.populateNewznabSection();for(var c=b.getMeta("NEWZNAB_PROVIDERS").split("!!!"),d=0;d<c.length;d++){var e=c[d];e.length>0&&b.config.providers.addNewznabProvider.apply(this,e.split("|"))}for(var f=b.getMeta("TORRENTRSS_PROVIDERS").split("!!!"),g=0;g<f.length;g++){var h=f[g];h.length>0&&b.config.providers.addTorrentRssProvider.apply(this,h.split("|"))}b.config.providers.showHideProviders()},showHideProviders:function(){a(".providerDiv").each(function(){var b=a(this).attr("id"),c=a("#editAProvider :selected").val();c+"Div"===b?a(this).show():a(this).hide()})},findProvider:function(a,b){var c=!1;return a.forEach(function(a){a.name===b&&(c=!0),console.log(a.name+" while searching for: "+b)}),c},getNewznabCategories:function(c,d){var e=d[0],f=d[1],g=d[2];if(e&&f&&g){var h={url:f,name:e,key:g};a(".updating_categories").wrapInner("<span>"+b.loading+" Updating Categories ...</span>"),a.getJSON("/config/providers/getNewznabCategories",h,function(a){b.config.providers.updateNewznabCaps(a,d)}).always(function(){a(".updating_categories").empty()})}},addNewznabProvider:function(c,d,e,f,g,h,i){e=a.trim(e),e&&(/^https?:\/\//i.test(e)||(e="http://"+e),null===e.match("/$")&&(e+="/"),b.config.providers.newznabProviders[c]=[h,[d,e,f,g]],"true"!==h&&(a("#editANewznabProvider").addOption(c,d),b.config.providers.populateNewznabSection()),0===a("#provider_order_list > #"+c).length&&"false"!==i&&(a("#provider_order_list").append('<li class="ui-state-default" id="'+c+'"> <input type="checkbox" id="enable_'+c+'" class="provider_enabler" CHECKED> <a href="'+b.anon_url(e)+'" class="imgLink" target="_new"><img src="/images/providers/nzb.png" alt="'+d+'" width="16" height="16"></a> '+d+"</li>"),a("#provider_order_list").sortable("refresh")),b.config.providers.refreshProviderList())},updateNewznabProvider:function(a,c,d,e){b.config.providers.newznabProviders[a][1][1]=c,b.config.providers.newznabProviders[a][1][2]=d,b.config.providers.newznabProviders[a][1][3]=e,b.config.providers.populateNewznabSection(),b.config.providers.refreshProviderList()},deleteNewznabProvider:function(c){a("#editANewznabProvider").removeOption(c),b.config.providers.populateNewznabSection(),a("li").remove("#"+c),delete b.config.providers.newznabProviders[c],b.config.providers.refreshProviderList()},populateNewznabSection:function(){var c=a("#editANewznabProvider :selected").val(),d="",e="",f="";"addNewznab"===c?(d=["","",""],e="false",a("#newznab_add_div").show(),a("#newznab_update_div").hide(),a("#newznab_cat").attr("disabled","disabled"),a("#newznab_cap").attr("disabled","disabled"),a("#newznab_cat_update").attr("disabled","disabled"),a("#newznabcapdiv").hide(),a("#newznab_cat option").each(function(){a(this).remove()}),a("#newznab_cap option").each(function(){a(this).remove()})):(d=b.config.providers.newznabProviders[c][1],e=b.config.providers.newznabProviders[c][0],a("#newznab_add_div").hide(),a("#newznab_update_div").show(),a("#newznab_cat").removeAttr("disabled"),a("#newznab_cap").removeAttr("disabled"),a("#newznab_cat_update").removeAttr("disabled"),a("#newznabcapdiv").show()),a("#newznab_name").val(d[0]),a("#newznab_url").val(d[1]),a("#newznab_key").val(d[2]),f="string"==typeof d[3]?d[3].split(","):d[3];var g=[];f&&(f.forEach(function(a){""!==a&&g.push({text:a,value:a})}),b.config.providers.replaceProviderOptions("#newznab_cat",g)),"addNewznab"===c?(a("#newznab_name").removeAttr("disabled"),a("#newznab_url").removeAttr("disabled")):(a("#newznab_name").attr("disabled","disabled"),"true"===e?(a("#newznab_url").attr("disabled","disabled"),a("#newznab_delete").attr("disabled","disabled")):(a("#newznab_url").removeAttr("disabled"),a("#newznab_delete").removeAttr("disabled"),d[0]&&d[1]&&d[2]&&!b.config.providers.findProvider(b.config.providers.newznabProvidersCapabilities,d[0])&&b.config.providers.getNewznabCategories(e,d),b.config.providers.updateNewznabCaps(null,d)))},updateNewznabCaps:function(a,c){a&&!b.config.providers.findProvider(b.config.providers.newznabProvidersCapabilities,c[0])&&b.config.providers.newznabProvidersCapabilities.push({name:c[0],categories:a.tv_categories}),c[0]&&b.config.providers.newznabProvidersCapabilities.forEach(function(a){if(a.name&&a.name===c[0]&&a.categories instanceof Array){var d=[];a.categories.forEach(function(a){a.id&&a.name&&d.push({value:a.id,text:a.name+"("+a.id+")"})}),b.config.providers.replaceProviderOptions("#newznab_cap",d)}})},addTorrentRssProvider:function(c,d,e,f,g,h,i){b.config.providers.torrentRssProviders[c]=[d,e,f,g],"true"!==h&&(a("#editATorrentRssProvider").addOption(c,d),b.config.providers.populateTorrentRssSection()),0===a("#provider_order_list > #"+c).length&&"false"!==i&&(a("#provider_order_list").append('<li class="ui-state-default" id="'+c+'"> <input type="checkbox" id="enable_'+c+'" class="provider_enabler" CHECKED> <a href="'+b.anon_url(e)+'" class="imgLink" target="_new"><img src="/images/providers/torrent.png" alt="'+d+'" width="16" height="16"></a> '+d+"</li>"),a("#provider_order_list").sortable("refresh")),b.config.providers.refreshProviderList()},updateTorrentRssProvider:function(a,c,d,e){b.config.providers.torrentRssProviders[a][1]=c,b.config.providers.torrentRssProviders[a][2]=d,b.config.providers.torrentRssProviders[a][3]=e,b.config.providers.populateTorrentRssSection(),b.config.providers.refreshProviderList()},deleteTorrentRssProvider:function(c){a("#editATorrentRssProvider").removeOption(c),b.config.providers.populateTorrentRssSection(),a("li").remove("#"+c),delete b.config.providers.torrentRssProviders[c],b.config.providers.refreshProviderList()},populateTorrentRssSection:function(){var c=a("#editATorrentRssProvider :selected").val(),d="";"addTorrentRss"===c?(d=["","","","title"],a("#torrentrss_add_div").show(),a("#torrentrss_update_div").hide()):(d=b.config.providers.torrentRssProviders[c],a("#torrentrss_add_div").hide(),a("#torrentrss_update_div").show()),
a("#torrentrss_name").val(d[0]),a("#torrentrss_url").val(d[1]),a("#torrentrss_cookies").val(d[2]),a("#torrentrss_titleTAG").val(d[3]),"addTorrentRss"===c?(a("#torrentrss_name").removeAttr("disabled"),a("#torrentrss_url").removeAttr("disabled"),a("#torrentrss_cookies").removeAttr("disabled"),a("#torrentrss_titleTAG").removeAttr("disabled")):(a("#torrentrss_name").attr("disabled","disabled"),a("#torrentrss_url").removeAttr("disabled"),a("#torrentrss_cookies").removeAttr("disabled"),a("#torrentrss_titleTAG").removeAttr("disabled"),a("#torrentrss_delete").removeAttr("disabled"))},makeTorrentOptionString:function(b){var c=a(".providerDiv_tip #"+b+"_seed_ratio").prop("value"),d=a(".providerDiv_tip #"+b+"_seed_time").prop("value"),e=a(".providerDiv_tip #"+b+"_process_method").prop("value"),f=a(".providerDiv_tip #"+b+"_option_string");f.val([c,d,e].join("|"))},refreshProviderList:function(){var c=a("#provider_order_list").sortable("toArray"),d=[],e=[];a.each(c,function(b,c){var e=+a("#enable_"+c).prop("checked")?"1":"0";d.push(c+":"+e)});for(var f in b.config.providers.newznabProviders)b.config.providers.newznabProviders.hasOwnProperty(f)&&e.push("newznab|"+b.config.providers.newznabProviders[f][1].join("|"));for(var g in b.config.providers.torrentRssProviders)b.config.providers.torrentRssProviders.hasOwnProperty(g)&&e.push("torrentrss|"+b.config.providers.torrentRssProviders[g].join("|"));a("#provider_strings").val(e.join(" ")),a("#provider_order").val(d.join(" ")),b.config.providers.refreshEditAProvider()},refreshEditAProvider:function(){a("#provider-list").empty();var c=a("#provider_order_list").sortable("toArray"),d=[];if(a.each(c,function(b,c){a("#enable_"+c).prop("checked")&&d.push(c)}),d.length>0){a("<select>").prop("id","editAProvider").addClass("form-control input-sm").appendTo("#provider-list");for(var e=0;e<d.length;e++){var f=d[e];a("#editAProvider").append(a("<option>").prop("value",f).text(a.trim(a("#"+f).text()).replace(/\s\*$/,"").replace(/\s\*\*$/,"")))}}else document.getElementsByClassName("component-desc")[0].innerHTML="No providers available to configure.";b.config.providers.showHideProviders()},replaceProviderOptions:function(b,c){a(b).empty(),a.each(c,function(c,d){a(b).append(a("<option></option>").attr("value",d.value).text(d.text))})}}},manage:{init:function(){},episode_statuses:function(){function b(b,c,d,e,f){var g="";return g+=' <tr class="'+a("#row_class").val()+" show-"+b+'">',g+='  <td class="tableleft" align="center"><input type="checkbox" class="'+b+'-epcheck" name="'+b+"-"+c+"x"+d+'"'+(f?" checked":"")+"></td>",g+="  <td>"+c+"x"+d+"</td>",g+='  <td class="tableright" style="width: 100%">'+e+"</td>",g+=" </tr>"}a(".allCheck").click(function(){var b=a(this).attr("id").split("-")[1];a("."+b+"-epcheck").prop("checked",a(this).prop("checked"))}),a(".get_more_eps").click(function(){var c=a(this).attr("id"),d=a("#allCheck-"+c).prop("checked"),e=a("tr#"+c),f=a(this).attr("data-clicked"),g=a(this).attr("value");f?"collapse"===g.toLowerCase()?(a("table tr").filter(".show-"+c).hide(),a(this).prop("value","Expand")):"expand"===g.toLowerCase()&&(a("table tr").filter(".show-"+c).show(),a(this).prop("value","Collapse")):(a.getJSON("/manage/showEpisodeStatuses",{indexer_id:c,whichStatus:a("#oldStatus").val()},function(f){a.each(f,function(f,g){a.each(g,function(a,g){e.after(b(c,f,a,g,d))})})}),a(this).attr("data-clicked",1),a(this).prop("value","Collapse"))}),a(".selectAllShows").click(function(){a(".allCheck").each(function(){a(this).prop("checked",!0)}),a('input[class*="-epcheck"]').each(function(){a(this).prop("checked",!0)})}),a(".unselectAllShows").click(function(){a(".allCheck").each(function(){a(this).prop("checked",!1)}),a('input[class*="-epcheck"]').each(function(){a(this).prop("checked",!1)})})},mass_update:function(){a("#massUpdateTable:has(tbody tr)").tablesorter({sortList:[[1,0]],textExtraction:{2:function(b){return a(b).find("span").text().toLowerCase()},3:function(b){return a(b).find("img").attr("alt")},4:function(b){return a(b).find("img").attr("alt")},5:function(b){return a(b).find("img").attr("alt")},6:function(b){return a(b).find("img").attr("alt")},7:function(b){return a(b).find("img").attr("alt")},8:function(b){return a(b).find("img").attr("alt")},9:function(b){return a(b).find("img").attr("alt")}},widgets:["zebra"],headers:{0:{sorter:!1},1:{sorter:"showNames"},2:{sorter:"quality"},3:{sorter:"sports"},4:{sorter:"scene"},5:{sorter:"anime"},6:{sorter:"flatfold"},7:{sorter:"archive_firstmatch"},8:{sorter:"paused"},9:{sorter:"subtitle"},10:{sorter:"default_ep_status"},11:{sorter:"status"},12:{sorter:!1},13:{sorter:!1},14:{sorter:!1},15:{sorter:!1},16:{sorter:!1},17:{sorter:!1}}}),a("#submitMassEdit").on("click",function(){var b=[];a(".showCheck:checked").each(function(){b.push(a(this).attr("id"))}),0!==b.length&&(window.location.href="massEdit?toEdit="+b.join("|"))}),a("#submitMassUpdate").on("click",function(){var b=[];a(".showCheck:checked").each(function(){b.push(a(this).attr("id"))}),0!==b.length&&(window.location.href="massUpdate?toUpdate="+b.join("|"))}),a("#submitMassRescan").on("click",function(){var b=[];a(".showCheck:checked").each(function(){b.push(a(this).attr("id"))}),0!==b.length&&(window.location.href="massUpdate?toRefresh="+b.join("|"))}),a("#submitMassRename").on("click",function(){var b=[];a(".showCheck:checked").each(function(){b.push(a(this).attr("id"))}),0!==b.length&&(window.location.href="massUpdate?toRename="+b.join("|"))}),a("#submitMassDelete").on("click",function(){var b=[];a(".showCheck:checked").each(function(){b.push(a(this).attr("id"))}),0!==b.length&&a.bootbox.confirm("You have selected to delete "+b.length+" show(s).  Are you sure you wish to continue? All files will be removed from your system.",function(a){a&&(window.location.href="massUpdate?toDelete="+b.join("|"))})}),a("#submitMassRemove").on("click",function(){var b=[];a(".showCheck:checked").each(function(){b.push(a(this).attr("id"))}),0!==b.length&&(window.location.href="massUpdate?toRemove="+b.join("|"))}),a(".bulkCheck").on("click",function(){a(".showCheck").each(function(){a(this).disabled||a(this).prop("checked",!this.checked)})})},mass_edit:{init:function(){a(".new_root_dir").change(function(){var c=b.manage.mass_edit.findDirIndex(a(this).attr("id"));a("#display_new_root_dir_"+c).html("<b>"+a(this).val()+"</b>")}),a(".edit_root_dir").click(function(){var c=b.manage.mass_edit.findDirIndex(a(this).attr("id")),d=a("#new_root_dir_"+c).val();a(this).nFileBrowser(b.manage.mass_edit.editRootDir,{initialDir:d,whichId:c})}),a(".delete_root_dir").click(function(){var c=b.manage.mass_edit.findDirIndex(a(this).attr("id"));a("#new_root_dir_"+c).val(null),a("#display_new_root_dir_"+c).html("<b>DELETED</b>")})},findDirIndex:function(a){var b=a.split("_");return b[b.length-1]},editRootDir:function(b,c){a("#new_root_dir_"+c.whichId).val(b),a("#new_root_dir_"+c.whichId).change()}},backlog_overview:function(){a("#pickShow").change(function(){var b=a(this).val();b&&a("html,body").animate({scrollTop:a("#show-"+b).offset().top-25},"slow")})},failed_downloads:function(){a("#failedTable:has(tbody tr)").tablesorter({widgets:["zebra"],sortList:[[0,0]],headers:{3:{sorter:!1}}}),a("#limit").change(function(){window.location.href="/manage/failedDownloads/?limit="+a(this).val()}),a("#submitMassRemove").on("click",function(){var b=[];return a(".removeCheck").each(function(){a(this).prop("checked")&&b.push(a(this).attr("id").split("-")[1])}),0!==b.length&&void(window.location.href="/manage/failedDownloads?toRemove="+b.join("|"))}),a(".bulkCheck").on("click",function(){var b=this,c=a(b).attr("id");a("."+c+":visible").each(function(){a(this).prop("checked",b.checked)})}),a(".removeCheck").forEach(function(b){var c=null;a(b).click(function(d){if(!c||!d.shiftKey)return void(c=this);var e=this,f=0;a(b+":visible").each(function(){switch(f){case 2:return!1;case 1:a(this).prop("checked",c.checked)}this!==e&&this!==c||f++})})})},subtitles_missed:function(){function b(a,b,c,d,e,f){f=f?" checked":"";var g="";return g+=' <tr class="good show-'+a+'">',g+='  <td align="center"><input type="checkbox" class="'+a+'-epcheck" name="'+a+"-"+b+"x"+c+'"'+f+"></td>",g+='  <td style="width: 1%;">'+b+"x"+c+"</td>",g+="  <td>"+d+"</td>",g+=" </tr>"}a(".allCheck").click(function(){var b=a(this).attr("id").split("-")[1];a("."+b+"-epcheck").prop("checked",a(this).prop("checked"))}),a(".get_more_eps").click(function(){var c=a(this).attr("id"),d=a("#allCheck-"+c).prop("checked"),e=a("tr#"+c),f=a(this).attr("data-clicked"),g=a(this).attr("value");f?"Collapse"===g?(a("table tr").filter(".show-"+c).hide(),a(this).prop("value","Expand")):"Expand"===g&&(a("table tr").filter(".show-"+c).show(),a(this).prop("value","Collapse")):(a.getJSON("/manage/showSubtitleMissed",{indexer_id:c,whichSubs:a("#selectSubLang").val()},function(f){a.each(f,function(f,g){a.each(g,function(a,g){e.after(b(c,f,a,g.name,g.subtitles,d))})})}),a(this).attr("data-clicked",1),a(this).prop("value","Collapse"))}),a(".selectAllShows").click(function(){a(".allCheck").each(function(){a(this).prop("checked",!0)}),a('input[class*="-epcheck"]').each(function(){a(this).prop("checked",!0)})}),a(".unselectAllShows").click(function(){a(".allCheck").each(function(){a(this).prop("checked",!1)}),a('input[class*="-epcheck"]').each(function(){a(this).prop("checked",!1)})})}},logs:{init:function(){},view:function(){a("#minLevel,#logFilter,#logSearch").on("keyup change",_.debounce(function(){a("#logSearch").val().length>0&&(a('#logFilter option[value="<NONE>"]').prop("selected",!0),a("#minLevel option[value=5]").prop("selected",!0)),a("#minLevel").prop("disabled",!0),a("#logFilter").prop("disabled",!0),document.body.style.cursor="wait";var b="/logs/viewlog/?minLevel="+a("select[name=minLevel]").val()+"&logFilter="+a("select[name=logFilter]").val()+"&logSearch="+a("#logSearch").val();a.get(b,function(c){history.pushState("data","",b),a("pre").html(a(c).find("pre").html()),a("#minLevel").prop("disabled",!1),a("#logFilter").prop("disabled",!1),document.body.style.cursor="default"})},500))}}};({init:function(){var a=document.body,b=a.getAttribute("data-controller"),c=a.getAttribute("data-action");this.exec("common"),this.exec(b),this.exec(b,c)},exec:function(a,c){c=void 0===c?"init":c,""!==a&&b[a]&&b[a][c]&&{object:b[a][c].init,function:b[a][c]}[typeof b[a][c]]()}}).init()});